<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 9 N Parameters | Gov 50: Data" />
<meta property="og:type" content="book" />



<meta name="github-repo" content="davidkane9/PPBDS" />



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="Chapter 9 N Parameters | Gov 50: Data">

<title>Chapter 9 N Parameters | Gov 50: Data</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Gov 50: Data<p><p class="author"></p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html"></a>
<a href="preamble.html">Preamble</a>
<a href="shopping-week.html">Shopping Week</a>
<a href="visualization.html"><span class="toc-section-number">1</span> Visualization</a>
<a href="wrangling.html"><span class="toc-section-number">2</span> Wrangling</a>
<a href="rubin-causal-model.html"><span class="toc-section-number">3</span> Rubin Causal Model</a>
<a href="functions.html"><span class="toc-section-number">4</span> Functions</a>
<a href="probability.html"><span class="toc-section-number">5</span> Probability</a>
<a href="one-parameter.html"><span class="toc-section-number">6</span> One Parameter</a>
<a href="two-parameters.html"><span class="toc-section-number">7</span> Two Parameters</a>
<a href="three-parameters.html"><span class="toc-section-number">8</span> Three Parameters</a>
<a id="active-page" href="n-parameters.html"><span class="toc-section-number">9</span> N Parameters</a><ul class="toc-sections">
<li class="toc"><a href="#eda-of-governors"> EDA of <code>governors</code></a></li>
<li class="toc"><a href="#wisdom"> Wisdom</a></li>
<li class="toc"><a href="#justice-and-courage"> Justice and Courage</a></li>
<li class="toc"><a href="#temperance"> Temperance</a></li>
<li class="toc"><a href="#eda-of-shaming"> EDA of <code>shaming</code></a></li>
<li class="toc"><a href="#causal-effects-of-treament"> Causal Effects of <code>treament</code></a></li>
</ul>
<a href="model-choice.html"><span class="toc-section-number">10</span> Model Choice</a>
<a href="continuous-response.html"><span class="toc-section-number">11</span> Continuous Response</a>
<a href="discrete-response.html"><span class="toc-section-number">12</span> Discrete Response</a>
<a href="appendices.html">Appendices</a>
<a href="tools.html">Tools</a>
<a href="shiny.html">Shiny</a>
<a href="maps.html">Maps</a>
<a href="animation.html">Animation</a>
<a href="references.html">References</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="n-parameters" class="section level1">
<h1>
<span class="header-section-number">Chapter 9</span> N Parameters</h1>
<p>Having created models with one parameter in Chapter <a href="one-parameter.html#one-parameter">6</a>, two parameters in Chapter <a href="two-parameters.html#two-parameters">7</a> and three parameters in Chapter <a href="three-parameters.html#three-parameters">8</a>, you are now ready to make the jump to <span class="math inline">\(N\)</span> parameters.</p>
<p>In this chapter, we will consider models with multiple parameters and the complexities that arise therefrom.</p>
<!-- DK: Add some more. What are the key lessons? What do we carry over from previous chapters? What is new? Hit the data science research cycle. -->
<div id="eda-of-governors" class="section level2">
<h2>
<span class="header-section-number">9.1</span> EDA of <code>governors</code>
</h2>
<p>Load packages:</p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="n-parameters.html#cb930-1"></a><span class="kw">library</span>(PPBDS.data)</span>
<span id="cb930-2"><a href="n-parameters.html#cb930-2"></a><span class="kw">library</span>(skimr)</span>
<span id="cb930-3"><a href="n-parameters.html#cb930-3"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb930-4"><a href="n-parameters.html#cb930-4"></a><span class="kw">library</span>(rstanarm)</span></code></pre></div>
<!-- DK: Perhaps we need more detail in this EDA?  Explain how we only have data for people who are already dead. That is an interesting restriction, and effects the Preceptor Table in interesting ways. Or is such a discussion too advanced? -->
<!-- DK: Don't keep around variables other than the ones we end up using. -->
<!-- DK: Provide proper citation to Barfort et al. -->
<!-- DK: Go and change governors data to use better variable names than the ones we have here. Maybe switch to years instead of days. Or maybe just clean them up here. -->
<p>We will start off by using a subset of the <code>governors</code> data set from the <strong>PPBDS.data</strong> package. This data set looks at the lifespans of candidates for governor in the US. It comes from the paper “Longevity Returns to Political Office” by Barfort, Klemmensen and Larsen (2019), which concludes that winning a gubernatorial election increases a candidate’s lifespan.</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="n-parameters.html#cb931-1"></a><span class="kw">glimpse</span>(governors)</span></code></pre></div>
<pre><code>## Rows: 1,092
## Columns: 11
## $ state      &lt;chr&gt; "Alabama", "Alabama", "Alabama", "Alabama", "Alabama", "Al…
## $ year       &lt;int&gt; 1946, 1946, 1950, 1954, 1954, 1958, 1962, 1966, 1966, 1970…
## $ first_name &lt;chr&gt; "James", "Lyman", "Gordon", "Tom", "James", "William", "Ge…
## $ last_name  &lt;chr&gt; "Folsom", "Ward", "Persons", "Abernethy", "Folsom", "Longs…
## $ party      &lt;chr&gt; "Democrat", "Republican", "Democrat", "Republican", "Democ…
## $ sex        &lt;chr&gt; "Male", "Male", "Male", "Male", "Male", "Male", "Male", "M…
## $ died       &lt;date&gt; 1987-11-21, 1948-12-17, 1965-05-29, 1968-03-07, 1987-11-2…
## $ status     &lt;chr&gt; "Challenger", "Challenger", "Challenger", "Challenger", "C…
## $ win_margin &lt;dbl&gt; 77.3, -77.3, 82.2, -46.7, 46.7, -77.5, 100.0, -34.3, 34.3,…
## $ alive_post &lt;int&gt; 14991, 773, 5319, 4871, 12069, 19924, 13096, 18622, 549, 1…
## $ alive_pre  &lt;int&gt; 13906, 28690, 17805, 17001, 16828, 12152, 15778, 17597, 14…</code></pre>
<p>There are 11 variables and 1092 observations. In this Chapter, we will only be looking at the variables <code>last_name</code>, <code>year</code>, <code>state</code>, <code>sex</code>, <code>alive_post</code>, and <code>alive_pre</code>.</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="n-parameters.html#cb933-1"></a>ch9_gov &lt;-<span class="st"> </span>governors <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb933-2"><a href="n-parameters.html#cb933-2"></a><span class="st">  </span><span class="kw">select</span>(last_name, year, state, sex, alive_post, alive_pre)</span></code></pre></div>
<p>There are a few things to note when looking at this data. First, the data set includes the variables <code>alive_pre</code> and <code>alive_post</code>, which tell us how many days a candidate lived before the election took place and how many days a candidate lived after the election, respectively. As a consequence, only politicians who are already deceased are included in this data set. This means that there are only a handful of observations from elections in the last 20 years. Most candidates from that time period are still alive and are, therefore, excluded.</p>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="n-parameters.html#cb934-1"></a><span class="kw">sample_n</span>(ch9_gov, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 6
##   last_name  year state        sex    alive_post alive_pre
##   &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;int&gt;     &lt;int&gt;
## 1 Ristine    1964 Indiana      Male        16298     16362
## 2 Sundlun    1986 Rhode Island Male         9024     24397
## 3 Richards   1990 Texas        Female       5791     20884
## 4 Turner     1946 Oklahoma     Male         9715     18991
## 5 Williams   1948 Michigan     Male        14333     13770</code></pre>
<p><code>sex</code> is most often “Male”, as we might expect.</p>
<!-- DK: Weird that this automagically creates a "TABLE 9.1: Data summary" side margin note. -->
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="n-parameters.html#cb936-1"></a><span class="kw">skim</span>(ch9_gov)</span></code></pre></div>
<p><!--
<caption>--><span class="marginnote shownote"><span id="tab:unnamed-chunk-736">TABLE 9.1: </span>Data summary</span><!--</caption>--></p>
<table><tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">ch9_gov</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">1092</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody></table>
<p><strong>Variable type: character</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">last_name</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">615</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">state</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">50</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1965</td>
<td align="right">13</td>
<td align="right">1945</td>
<td align="right">1954</td>
<td align="right">1962</td>
<td align="right">1974</td>
<td align="right">2011</td>
<td align="left">▇▆▃▂▁</td>
</tr>
<tr class="even">
<td align="left">alive_post</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">10310</td>
<td align="right">4886</td>
<td align="right">46</td>
<td align="right">6419</td>
<td align="right">10811</td>
<td align="right">14124</td>
<td align="right">22067</td>
<td align="left">▃▆▇▆▂</td>
</tr>
<tr class="odd">
<td align="left">alive_pre</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">18892</td>
<td align="right">3181</td>
<td align="right">11450</td>
<td align="right">16561</td>
<td align="right">18758</td>
<td align="right">20996</td>
<td align="right">30633</td>
<td align="left">▂▇▆▂▁</td>
</tr>
</tbody>
</table>
<p>This output groups the variables together by type. We are given histograms of the numerical data. In looking at the histogram for <code>year</code>, we see that it is skewed right, with half of the observations from election years between 1945 and 1962. This makes sense logically, because we are only looking at deceased candidates, and candidates from more recent elections are more likely to still be alive.</p>
<p>In using this data set, our left-side variable will be <code>alive_post</code>. We are trying to understand/predict how many days a candidate will live after the election.</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="n-parameters.html#cb937-1"></a>ch9_gov <span class="op">%&gt;%</span></span>
<span id="cb937-2"><a href="n-parameters.html#cb937-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> alive_post)) <span class="op">+</span></span>
<span id="cb937-3"><a href="n-parameters.html#cb937-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb937-4"><a href="n-parameters.html#cb937-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"US Gubernatorial Candidate Lifespans"</span>,</span>
<span id="cb937-5"><a href="n-parameters.html#cb937-5"></a>       <span class="dt">subtitle =</span> <span class="st">"Candidates who died more recently can't have lived for long post-election"</span>,</span>
<span id="cb937-6"><a href="n-parameters.html#cb937-6"></a>       <span class="dt">caption =</span> <span class="st">"Data: Barfort, Klemmensen and Larsen (2019)"</span>,</span>
<span id="cb937-7"><a href="n-parameters.html#cb937-7"></a>       <span class="dt">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb937-8"><a href="n-parameters.html#cb937-8"></a>       <span class="dt">y =</span> <span class="st">"Days Lived After Election"</span>) <span class="op">+</span></span>
<span id="cb937-9"><a href="n-parameters.html#cb937-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_number</span>()) </span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-737-1.png" width="672"></p>
<p>Starting with the relationship between <code>alive_post</code> and <code>year</code>, we can see that the data is skewed right and that there is a rough line above which there are no observations. There are no data points in the top right portion of the graph because it is not possible to have run in 2011, lived 20,000 days after the election took place, and still have died before the data set was created. This line represents, approximately, the most days a candidate could have possibly lived — and still have died. The reason this line is slanted downward is because the maximum value for this scenario is greater in earlier years. That is, those candidates who ran for governor in earlier years could live a long time after the election and still have died prior to the data set creation, giving them higher <code>alive_post</code> values than those who ran for office in more recent years.</p>
<p>There are fewer observations in later years because fewer recent candidates have died.</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="n-parameters.html#cb938-1"></a>ch9_gov <span class="op">%&gt;%</span></span>
<span id="cb938-2"><a href="n-parameters.html#cb938-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sex, <span class="dt">y =</span> alive_post)) <span class="op">+</span></span>
<span id="cb938-3"><a href="n-parameters.html#cb938-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb938-4"><a href="n-parameters.html#cb938-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"US Gubernatorial Candidate Lifespans"</span>,</span>
<span id="cb938-5"><a href="n-parameters.html#cb938-5"></a>       <span class="dt">subtitle =</span> <span class="st">"Male candidates live much longer after the election"</span>,</span>
<span id="cb938-6"><a href="n-parameters.html#cb938-6"></a>       <span class="dt">caption =</span> <span class="st">"Data: Barfort, Klemmensen and Larsen (2019)"</span>,</span>
<span id="cb938-7"><a href="n-parameters.html#cb938-7"></a>       <span class="dt">x =</span> <span class="st">"Gender"</span>,</span>
<span id="cb938-8"><a href="n-parameters.html#cb938-8"></a>       <span class="dt">y =</span> <span class="st">"Days Lived After Election"</span>) <span class="op">+</span></span>
<span id="cb938-9"><a href="n-parameters.html#cb938-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_number</span>()) </span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-738-1.png" width="672"></p>
<p>This plot shows that men live much longer, on average, than women after the election. Does that make sense to you?</p>
</div>
<div id="wisdom" class="section level2">
<h2>
<span class="header-section-number">9.2</span> Wisdom</h2>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:unnamed-chunk-739"></span>
<img src="other/images/Wisdom.jpg" alt="Wisdom" width="1280"><!--
<p class="caption marginnote">-->FIGURE 9.1: Wisdom<!--</p>-->
<!--</div>--></span>
</p>
<p>The concept of the “population” is subtle and important. <em>The population is not the set of candidates for which we have data.</em> That is the data set. The population is the larger — potentially much larger — set of individuals about whom we want to make inferences. <em>The parameters in our models refer to the population, not to the data set.</em></p>
<p>Consider a simple example. Define <span class="math inline">\(\mu\)</span> as the average number of days lived by candidates for governor after Election Day. Can we calculate <span class="math inline">\(\mu\)</span> from our data? No! There are many candidates for governor who are still alive, who are not included in our data even though they are part of the “population” we want to study. <span class="math inline">\(\mu\)</span> can not be <em>calculated.</em> It can only be <em>estimated.</em></p>
<p>Note, also, that there are many different populations, each with its own <span class="math inline">\(\mu\)</span>, which we might be interested in.</p>
<!-- DK: Are these dates correct? -->
<ul>
<li><p>The population of all candidates for governor in the US from 1945 to 2012. This is the period covered in the paper.</p></li>
<li><p>The population of all candidates for governor in the US from 1900 to 2012. A priori, we would not expect a major difference between candidates who run in 1946 and those who run in 1942. How different could they be? It is therefore not unreasonable to extend the population of interest back in time, even if we have no data for earlier periods.</p></li>
<li><p>The population of all candidates for governor in the US from 1945 to 2030. We are often interested in the future. We want to make predictions about what will happen to candidates, even to candidates who have not yet run for office.</p></li>
<li><p>The population of candidates for governor around the world. Other countries have governors also! We want to understand their longevity as well.</p></li>
<li><p>The population of candidates for all political offices in the US. We might expect candidates for Senator to have similar lifespans to candidates for Governor.</p></li>
<li><p>And so on. There are as many possible populations are there are questions we might ask.</p></li>
</ul>
<p>All of these populations are different, so each has a different <span class="math inline">\(\mu\)</span>. Which <span class="math inline">\(\mu\)</span> we are interested in depends on the problem we are trying to solve. It is a judgment call, a matter of Wisdom, as to whether or not that data we have is “close enough” to the population we are interested in to justify making a model.</p>
<!-- DK: Add more? Talk about ethics? Connect to ideal Preceptor Table? -->
</div>
<div id="justice-and-courage" class="section level2">
<h2>
<span class="header-section-number">9.3</span> Justice and Courage</h2>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:unnamed-chunk-740"></span>
<img src="other/images/Justice.jpg" alt="Justice" width="960"><!--
<p class="caption marginnote">-->FIGURE 9.2: Justice<!--</p>-->
<!--</div>--></span>
</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:unnamed-chunk-741"></span>
<img src="other/images/Courage.jpg" alt="Courage" width="1024"><!--
<p class="caption marginnote">-->FIGURE 9.3: Courage<!--</p>-->
<!--</div>--></span>
</p>
<p>Because we will be going through a series of models in this chapter, it is useful to combine the virtues of Justice and Courage.</p>
<div id="alive_pre" class="section level3">
<h3>
<span class="header-section-number">9.3.1</span> alive_pre</h3>
<p>To begin, let’s model candidate lifespan after the election as a function of candidate lifespan prior to the election. The data:</p>
<p><img src="book_temp_files/figure-html/unnamed-chunk-742-1.png" width="672"></p>
<p>The math is fairly simple:</p>
<p><span class="math display">\[ alive\_post_i =  \beta_0 + \beta_1 alive\_pre_i + \epsilon_i \]</span></p>
<p>with <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>. <span class="math inline">\(alive\_post_i\)</span> is the number of days lived after the election for candidate <span class="math inline">\(i\)</span>. <span class="math inline">\(alive\_pre_i\)</span> is the number of days lived before the election for candidate <span class="math inline">\(i\)</span>. <span class="math inline">\(\epsilon_i\)</span> is the “error term,” the difference between the actual days-lived of candidate <span class="math inline">\(i\)</span> and the modeled days-lived. <span class="math inline">\(\epsilon_i\)</span> is normally distributed with a mean of 0 and a standard deviation of <span class="math inline">\(\sigma\)</span>. The key distinction is between:</p>
<ul>
<li><p><em>Variables</em>, always subscripted with <span class="math inline">\(i\)</span>, whose values (potentially) vary across individuals.</p></li>
<li><p><em>Parameters</em>, never subscripted with <span class="math inline">\(i\)</span>, whose values are constant across individuals.</p></li>
</ul>
<p><span class="math inline">\(\beta_0\)</span> is the “intercept” of the regression, the average value for the population of <span class="math inline">\(alive\_post\)</span> for those for whom <span class="math inline">\(alive\_pre = 0\)</span>. <span class="math inline">\(\beta_1\)</span> is the “coefficient” of <span class="math inline">\(alive\_pre\)</span>. Each one day increase in <span class="math inline">\(alive\_pre\)</span> is associated with a <span class="math inline">\(\beta_1\)</span> change in <span class="math inline">\(alive\_post\)</span>. Again, this is the value for the population from which our data is drawn.</p>
<p>Coming back to our model with <span class="math inline">\(alive\_pre\)</span>, there are three unknown parameters, similar to the situation we faced in Chapter <a href="three-parameters.html#three-parameters">8</a>.</p>
<p>You may recall from middle school algebra that the equation of a line is <span class="math inline">\(y = a + b x\)</span>. It is defined by two coefficients <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. The intercept coefficient <span class="math inline">\(a\)</span> is the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = 0\)</span>. The slope coefficient <span class="math inline">\(b\)</span> for <span class="math inline">\(x\)</span> is the increase in <span class="math inline">\(y\)</span> for every increase of one in <span class="math inline">\(x\)</span>. When defining a regression line, we use slightly different notation but the fundamental relationship is the same.</p>
<p>We can use <code>geom_smooth()</code> to create the fitted regression line:</p>
<p><img src="book_temp_files/figure-html/unnamed-chunk-743-1.png" width="672"></p>
<p>Consider someone who is about 15,000 days old on Election Day. We have a score or more data points for candidates around that age. Two died soon after the election. Some of them lived for about 5,000 days after the election. Others lived for more than 20,000 days. Variation fills the world. But the fitted line tells us that, on average, we would expect a candidate that age to live for about 15,000 days after the election.</p>
<!-- DK: Add a red circle to the graphic to show how we figured that out? -->
<p>This model, with a continuous independent (or “predictor”) variable, has an infinite number of fitted values, one for each possible value of <code>alive_pre</code>. This is very different from the models we saw in Chapter <a href="three-parameters.html#three-parameters">8</a>. Those models only had two possible fitted values because the predictor variable only took two possible values.</p>
<!-- DK: I am nervous that alive_pre, as used here, is a different variable that alive_pre when, later, we transform it.  -->
<p>We can implement this model with <code>stan_glm()</code>.</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="n-parameters.html#cb939-1"></a>fit_gov_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_gov,</span>
<span id="cb939-2"><a href="n-parameters.html#cb939-2"></a>                      <span class="dt">formula =</span> alive_post <span class="op">~</span><span class="st"> </span>alive_pre,</span>
<span id="cb939-3"><a href="n-parameters.html#cb939-3"></a>                      <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>As we discussed in Chapter <a href="three-parameters.html#three-parameters">8</a>, the most common term for a model like this is a “regression.” We have “regressed” <code>alive_post</code>, our dependent variable, on <code>alive_pre</code>, our (only) independent variable.</p>
<p>The parameter values:</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="n-parameters.html#cb940-1"></a><span class="kw">print</span>(fit_gov_<span class="dv">1</span>, <span class="dt">detail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##             Median  MAD_SD 
## (Intercept) 26532.8   715.2
## alive_pre      -0.9     0.0
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 4053.7   87.0</code></pre>
<p>As is almost always the case, <span class="math inline">\(\sigma\)</span> is a nuisance parameter, somethings whose value we are not interested in. This is why <code>stan_glm()</code> refers to it as an “Auxiliary” parameter.</p>
<p>The posterior distributions of <span class="math inline">\(\beta_0\)</span> (the intercept) and <span class="math inline">\(\beta_1\)</span> (the coefficient of <code>alive_pre</code>), on the other hand, are important. Before looking at the posteriors themselves, let’s examine the fitted values:</p>
<!-- DK: Use this trick to create parallel and non-parallel line plots later. -->
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="n-parameters.html#cb942-1"></a>ch9_gov <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb942-2"><a href="n-parameters.html#cb942-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> alive_pre, <span class="dt">y =</span> alive_post)) <span class="op">+</span></span>
<span id="cb942-3"><a href="n-parameters.html#cb942-3"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb942-4"><a href="n-parameters.html#cb942-4"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">fitted</span>(fit_gov_<span class="dv">1</span>)), <span class="dt">color =</span> <span class="st">"blue"</span>) <span class="op">+</span></span>
<span id="cb942-5"><a href="n-parameters.html#cb942-5"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Longevity of Gubernatorial Candidates"</span>,</span>
<span id="cb942-6"><a href="n-parameters.html#cb942-6"></a>         <span class="dt">subtitle =</span> <span class="st">"Blue line shows fitted values"</span>, </span>
<span id="cb942-7"><a href="n-parameters.html#cb942-7"></a>         <span class="dt">caption =</span> <span class="st">"Data Source: Barfort, Klemmensen and Larsen (2019)"</span>,</span>
<span id="cb942-8"><a href="n-parameters.html#cb942-8"></a>         <span class="dt">x =</span> <span class="st">"Age in Days"</span>,</span>
<span id="cb942-9"><a href="n-parameters.html#cb942-9"></a>         <span class="dt">y =</span> <span class="st">"Days Lived After Election"</span>) <span class="op">+</span></span>
<span id="cb942-10"><a href="n-parameters.html#cb942-10"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_number</span>()) <span class="op">+</span></span>
<span id="cb942-11"><a href="n-parameters.html#cb942-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_number</span>()) </span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-746-1.png" width="672"></p>
<p>This code is the same as the code we used above, except that we have replaced <code>geom_smooth()</code> with <code>geom_line()</code>. Calling <code>fitted()</code> on a model returns the set of fitted values, which we have plotted by hand.</p>
<!-- DK: Does this section work? If it does, we ought to do it in every chapter. If not, then why bother? It is certainly confusing to understand why sticking in the median is a good idea . . . -->
<p>We can create a formula for the fitted values by placing the median values of the parameters into the model:</p>
<p><span class="math display">\[ alive\_post_i =  26,524 - 0.9 alive\_pre_i + \epsilon_i\]</span></p>
<p>Consider the intercept. Since our independent variable is <code>alive_pre</code>, the intercept is the <code>alive_post</code> value when <code>alive_pre</code> is zero. Here, we would interpret this intercept as the average lifespan of a gubernatorial candidate after the election, if the candidate was alive for zero days prior to the election.</p>
<p>This is, of course, substantively nonsense. No one runs for office on the day they are born. In the next model, we will explore ways of making the intercept more interpretable. In the meantime, the math is the math.</p>
<p>Consider the coefficient for <code>alive_pre</code>, <span class="math inline">\(\beta_1\)</span>. The median of the posterior, -0.9, represents the slope of the model. For every unit increase in our independent variable, our dependent variable will change by this amount. For every additional day a candidate is alive before an election, their lifespan after the election will be 0.9 days lower, on average. If we are given the number of days a candidate lived before the election and want to estimate how long they will live for after, we will multiply the days they were alive prior by this beta of -0.9, then combine that with the intercept.</p>
<p>This is a descriptive model, not a causal model. Remember our motto from Chapter <a href="rubin-causal-model.html#rubin-causal-model">3</a>: <em>No causation without manipulation.</em> There is no way, for person <span class="math inline">\(i\)</span>, to change the days that she has been alive on Election Day. On the day of this election, she is X days old. There is no way to change that. So, there are not two (or more) potential outcomes. Without more than one potential outcome, there can not be a causal effect.</p>
<p>Given that, it is important to monitor our language. We do not believe that that changes in <code>alive_pre</code> “cause” changes in <code>alive_post</code>. That is obvious. But there are some words and phrases — like “associated with” and “change by” — which are too close to causal. (And which we are guilty of using just a few paragraphs ago!) Be wary of their use. <em>Always think in terms of comparisons</em> when using a predictive model. We can’t change <code>alive_pre</code> from X to Y for an individual candidate. We can only compare two candidates (or two groups of candidates), one with <code>alive_pre</code> equal to X and the other with <code>alive_pre</code> equal to Y. If our model is correct, such candidates will, on average, differ in <code>alive_post</code> by <span class="math inline">\(\beta_1\)</span> times the difference between X and Y.</p>
<!-- DK: THis is a critical point. Maybe give a precise example? Go through the math slowly, like ModernDive does? Highlight this somehow? At the very least, we should emphasize the point for each model going forward. -->
<p>Let’s look at the posterior of <span class="math inline">\(\beta_1\)</span>, the coefficient of <code>alive_pre</code>:</p>
<!-- DK: We should standardize what these plots look like, both in this chapter and throughout the book. -->
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="n-parameters.html#cb943-1"></a>fit_gov_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb943-2"><a href="n-parameters.html#cb943-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb943-3"><a href="n-parameters.html#cb943-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(alive_pre)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb943-4"><a href="n-parameters.html#cb943-4"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">after_stat</span>(count<span class="op">/</span><span class="kw">sum</span>(count))),</span>
<span id="cb943-5"><a href="n-parameters.html#cb943-5"></a>                   <span class="dt">bins =</span> <span class="dv">100</span>, ) <span class="op">+</span></span>
<span id="cb943-6"><a href="n-parameters.html#cb943-6"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Distribution of the Coefficient of `alive_pre`"</span>,</span>
<span id="cb943-7"><a href="n-parameters.html#cb943-7"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>,</span>
<span id="cb943-8"><a href="n-parameters.html#cb943-8"></a>         <span class="dt">x =</span> <span class="st">"Coefficient of `alive_pre`"</span>)</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-747-1.png" width="672"></p>
<!-- DK: Add some interpretation. Need to explain how the uncertainty in beta_1 is connected to the uncertainty we will see in alive_post, for a given difference (not "change") in alive_pre. -->
<!-- DK: Priority is to add a graphic which shows the "cloud" of possible regression lines, consistent with the posterior for beta_1.  -->
<!-- DK: Need a smoother transition back to centering. Or get rid of centering all together? -->
<p>Centering is a tool that is used when the model’s intercept does not make substantive sense. To center a model, we pick a constant value, usually the mean of the independent variable, and subtract that constant from every value of the independent variable.</p>
<p>In this example, we want to center the value for <code>alive_pre</code>, the independent variable. First, we must pick the value that we will center by. Here, we will use the mean of <code>alive_pre</code>. Once we find this value, we will subtract it from every <code>alive_pre</code> value. We have, thereby, changed the meaning of <code>alive_pre</code>. It now means the number of days a candidate has been alive, as of Election Day, relative to the average days alive of all candidates on their respective election days.</p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="n-parameters.html#cb944-1"></a>ch9_gov<span class="op">$</span>alive_pre &lt;-<span class="st"> </span>ch9_gov<span class="op">$</span>alive_pre <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(ch9_gov<span class="op">$</span>alive_pre)</span></code></pre></div>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="n-parameters.html#cb945-1"></a>fit_gov_<span class="fl">1.</span>centered &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_gov,</span>
<span id="cb945-2"><a href="n-parameters.html#cb945-2"></a>                      <span class="dt">formula =</span> alive_post <span class="op">~</span><span class="st"> </span>alive_pre,</span>
<span id="cb945-3"><a href="n-parameters.html#cb945-3"></a>                      <span class="dt">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb945-4"><a href="n-parameters.html#cb945-4"></a></span>
<span id="cb945-5"><a href="n-parameters.html#cb945-5"></a><span class="kw">print</span>(fit_gov_<span class="fl">1.</span>centered, <span class="dt">detail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##             Median  MAD_SD 
## (Intercept) 10310.4   120.0
## alive_pre      -0.9     0.0
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 4054.9   89.0</code></pre>
<!-- DK: If we are doing centering, then we ought to do it correctly, by showing side-by-side scatterplots with fitted lines, the better to show that we have just slid things over. -->
<p>We can see that the intercept has decreased while the slope has stayed the same. When we interpret this model, we only have to change the definition of the intercept. Rather than the intercept representing the lifespan of a candidate who was alive for zero days before running for governor, it now represents the post-election lifespan of a gubernatorial candidate who was alive for the mean number of days before running. In this instance, our center value is approximately 18,892, so we will use this value in our interpretation. If a candidate was alive for 18,892 days (about 52 years) before running for governor (the mean value in this data set), they are expected to live about 10,300 days (about 28 years) after the election, on average.</p>
<!-- DK: Really need the ideal and actual Preceptor Table for this example. -->
<p>Always think in terms of unknown parameters. What do they mean? Which population do they represent? What ideal Preceptor Table would make their calculation easy? In this case, <span class="math inline">\(\beta_0\)</span> could be interpreted as the average number of days which gubernatorial candidates live after election day. If we had the ideal Preceptor Table, this would be trivial to calculate. Just take the average! No estimation required. But, our actual Preceptor Table has lots of missing values. In particular, many gubernatorial candidates have not . . . uh . . . died. (How inconsiderate!) So, we can’t know how many days they will live. All we can do is estimate a posterior probability distribution for <span class="math inline">\(\beta_0\)</span>.</p>
</div>
<div id="sex" class="section level3">
<h3>
<span class="header-section-number">9.3.2</span> sex</h3>
<p>Let’s now regress <code>sex</code> on <code>alive_post</code> to see how candidates’ post-election lifespans differ by sex.</p>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="n-parameters.html#cb947-1"></a>fit_gov_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_gov,</span>
<span id="cb947-2"><a href="n-parameters.html#cb947-2"></a>                      <span class="dt">formula =</span> alive_post <span class="op">~</span><span class="st"> </span>sex <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb947-3"><a href="n-parameters.html#cb947-3"></a>                      <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>Note this workflow. Try one model. Interpret it. Try another model. And then another. There is no one “true” model. There is an infinite space of possible models. Good data science involves an intelligent tour of that space.</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="n-parameters.html#cb948-1"></a><span class="kw">print</span>(fit_gov_<span class="dv">2</span>, <span class="dt">detail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##           Median  MAD_SD 
## sexFemale  5838.0  1011.9
## sexMale   10398.5   141.7
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 4849.6  101.2</code></pre>
<p>In this regression, we use the -1 in the formula to make the output more straightforward, with no intercept to interpret. The math of this model is the same as those we saw in Chapter <a href="three-parameters.html#three-parameters">8</a>:</p>
<p><span class="math display">\[ y_i = \beta_1 x_{f,i} + \beta_2 x_{m,i} + \epsilon_i\]</span></p>
<p>where 
<span class="math display">\[x_{f,i}, x_{m,i} \in \{0,1\}\]</span> 
<span class="math display">\[x_{f,i} +  x_{m,i} = 1\]</span> 
<span class="math display">\[\epsilon_i \sim N(0, \sigma^2)\]</span></p>
<!-- DK: Provide more details on what each of the items in the formula means, even though this is a repeat of what we did in chapter 8. Don't use "where" with line skips. Just one paragrpah, like elsewhere. -->
<p>The meanings of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(\epsilon_i\)</span> are the same as in the first model. Indeed, they are the same throughout these exercises. <span class="math inline">\(x_{f,i}\)</span> and <span class="math inline">\(x_{m,i}\)</span> are 0/1 variables, just like last chapter. They are <em>variables</em> whose value varies across individuals.</p>
<p>The important parameters are <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>. They are the average days-lived post-election for, respectively, women and men. Again, this is not the “average” for the data we have. That is easy to calculate! No estimation required. <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> are averages for the entire “population,” however we have chosen to define that term. Those averages can not be calculated directly. They can only be estimated, by creating a posterior probability distribution.</p>
<p>Looking back to the regression model we just created, we see that there is no intercept. Instead of having a <span class="math inline">\(\beta_0\)</span> value, we have <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> for female and male. This makes things easier to interpret. Without having to add or subtract anything from an intercept, this regression tells us that, on average, women are expected to live about 6,000 days after running for governor, and men are expected to live 10,000 days.</p>
<p>This is a strange result. Why would men live twice as long as women after the election? One explanation for this might be that women don’t run for governor until later in life, and therefore are not expected to live as long.</p>
<!-- DK: Weird result, huh? Men live twice as long as women! Useful to discuss why that might be the case in more detail. -->
<p>Now that we have interpreted the model using a -1 in the formula to get both a <span class="math inline">\(\beta_1\)</span> value and a <span class="math inline">\(\beta_2\)</span> value, let’s take away the -1 and regress <code>alive_post</code> on an intercept and <code>sex</code> to see how our equation changes.</p>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="n-parameters.html#cb950-1"></a>fit_gov_2a &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_gov,</span>
<span id="cb950-2"><a href="n-parameters.html#cb950-2"></a>                       <span class="dt">formula =</span> alive_post <span class="op">~</span><span class="st"> </span>sex,</span>
<span id="cb950-3"><a href="n-parameters.html#cb950-3"></a>                       <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="n-parameters.html#cb951-1"></a><span class="kw">print</span>(fit_gov_2a, <span class="dt">detail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##             Median MAD_SD
## (Intercept) 5836.7 1062.6
## sexMale     4558.1 1076.7
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 4852.1  109.0</code></pre>
<p>We no longer have a value for female. However we do have an intercept. In this regression our mathematical formula is:</p>
<p><span class="math display">\[ y_i = \beta_0  + \beta_1 x_{m,i} + \epsilon_i\]</span></p>
<p><span class="math inline">\(\beta_0\)</span> is our intercept value which here would be around 5,850. This result is very similar to the female value from before. In this type of model, our intercept represents the characteristic of the variable that is left unrepresented in the model. <span class="math inline">\(\beta_1\)</span> only affects the outcome when the candidate is male. (If the candidate is female, then <span class="math inline">\(x_{m,i} = 0\)</span>. Therefore, the intercept value represents those who are not male, i.e., females.)</p>
<!-- DK: This explanation should be better. -->
<p>When the candidate is a male, we add the coefficient for male to the intercept value, which gives us the average lifespan of a male gubernatorial candidate after an election. As we can see from adding <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, this value is the same as what we got for males in the previous model.</p>
<p>Be careful with notation! <span class="math inline">\(\beta_1\)</span> in the no-intercept model is different from <span class="math inline">\(\beta_1\)</span> in the model with an intercept! Notation varies. We must pay attention each time we make a model.</p>
<p>The posterior distribution for <span class="math inline">\(\beta_0 + \beta_1\)</span> can be constructed via simple addition.</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="n-parameters.html#cb953-1"></a>fit_gov_2a <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb953-2"><a href="n-parameters.html#cb953-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb953-3"><a href="n-parameters.html#cb953-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">male_intercept =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>sexMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb953-4"><a href="n-parameters.html#cb953-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(male_intercept)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb953-5"><a href="n-parameters.html#cb953-5"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">after_stat</span>(count<span class="op">/</span><span class="kw">sum</span>(count))),</span>
<span id="cb953-6"><a href="n-parameters.html#cb953-6"></a>                   <span class="dt">bins =</span> <span class="dv">100</span>, ) <span class="op">+</span></span>
<span id="cb953-7"><a href="n-parameters.html#cb953-7"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Distribution of Average Male Candidate Days Left`"</span>,</span>
<span id="cb953-8"><a href="n-parameters.html#cb953-8"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>,</span>
<span id="cb953-9"><a href="n-parameters.html#cb953-9"></a>         <span class="dt">x =</span> <span class="st">"Male Days To Live After the Election"</span>)</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-754-1.png" width="672"></p>
<p>The interpretation of this parameter is the same as we have seen before. There is a true average, across the entire population, of the number of days that male candidates live after the election. We can never know what that true average is. But, it seems highly likely that the true average is somewhere between 10,000 and 10,750 days.</p>
</div>
<div id="alive_pre-and-sex" class="section level3">
<h3>
<span class="header-section-number">9.3.3</span> alive_pre and sex</h3>
<p>We are going to transition to working with a model that has more than one explanatory variable. Our outcome variable will be <code>alive_post</code>, but now we will have two different explanatory variables: <code>alive_pre</code> and <code>sex</code>. Note that <code>sex</code> is a categorical explanatory variable and <code>alive_pre</code> is a continuous explanatory variable.</p>
<p>Here is the math we will be using:</p>
<p><span class="math display">\[ y_i =  \beta_0 + \beta_1 male_i + \beta_2 alive\_pre_i + \epsilon_i \]</span></p>
<ul>
<li><p><span class="math inline">\(y_i\)</span> is our outcome variable. In our case, the outcome variable is <span class="math inline">\(alive\_post_i\)</span>, the number of days a person is alive after the election. <span class="math inline">\(male_i\)</span> is one of our explanatory variables. If we are predicting the amount of days a male candidate lives after the election, this value will be 1. When we are making this prediction for female candidates, this value will be 0. <span class="math inline">\(alive\_pre_i\)</span> is our other explanatory variable. It is the number of days a candidate has lived before the election.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> is the average number of days lived after the election for women, who on the day of election, have been alive the average number of days of all candidates (i.e. both male and female). <span class="math inline">\(\beta_0\)</span> is also the intercept of the equation. In other words, <span class="math inline">\(\beta_0\)</span> is the expected value of <span class="math inline">\(y_i\)</span>, if <span class="math inline">\(male_i\)</span> = 0 and <span class="math inline">\(alive\_pre\)</span> = 0. However, we can ignore that for our purposes because no one running for governor would have been alive 0 days before the election!</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> is almost meaningless by itself. The only time it has meaning is when its value is connected to our intercept (i.e. <span class="math inline">\(\beta_0\)</span> + <span class="math inline">\(\beta_1\)</span>). When the two are added together, you get the average number of days lived after the election for men, who on the day of election, have been alive the average number of days for all candidates.</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> is, for the entire population, the average difference in <span class="math inline">\(y_i\)</span> between two individuals, one of whom has an <code>alive_pre</code> value of 1 greater than the other.</p></li>
</ul>
<p>Now that we understand our model, let’s translate the following model into code.</p>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="n-parameters.html#cb954-1"></a>fit_gov_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_gov,</span>
<span id="cb954-2"><a href="n-parameters.html#cb954-2"></a>                      <span class="dt">formula =</span> alive_post <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>alive_pre,</span>
<span id="cb954-3"><a href="n-parameters.html#cb954-3"></a>                      <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="n-parameters.html#cb955-1"></a><span class="kw">print</span>(fit_gov_<span class="dv">3</span>, <span class="dt">detail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##             Median MAD_SD
## (Intercept) 8103.0  896.4
## sexMale     2252.4  888.7
## alive_pre     -0.8    0.0
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 4046.8   84.0</code></pre>
<p>Looking at our results, you can see that our intercept value is around 8,100. (The exact values for the median of the posterior will vary, because of the random sampling inherent in fitting the model.) This means that the average female candidate, who had been alive the average number of days of all candidates, would live another 8,100 days or so after the election.</p>
<p>Note that <code>sexMale</code> is around 2,250. This is our coefficient, <span class="math inline">\(\beta_1\)</span>. We need to connect this value to our intercept value to get something meaningful. Using the formula <span class="math inline">\(\beta_0\)</span> + <span class="math inline">\(\beta_1\)</span>, we find out that the number of days the average male candidate — who, on the day of election, had been alive the average number of days of all candidate — would live is around 10,300,.</p>
<p>Now take a look at the coefficient for <span class="math inline">\(alive\_pre_i\)</span>, <span class="math inline">\(\beta_2\)</span>. The median of the posterior, -0.8, represents the slope of the model. For every unit increase in our independent variable, our dependent variable will change by this coefficient. It makes sense that this value is negative. Think about it: the more days a candidate has lived, the fewer days the candidate has left to live. So, for every extra day a candidate is alive before an election, their lifespan after the election will be 0.8 days lower, on average.</p>
<p>Let’s now look at some posteriors.</p>
<div class="sourceCode" id="cb957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb957-1"><a href="n-parameters.html#cb957-1"></a>fit_gov_<span class="dv">3</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb957-2"><a href="n-parameters.html#cb957-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb957-3"><a href="n-parameters.html#cb957-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">male_days =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>sexMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb957-4"><a href="n-parameters.html#cb957-4"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">female_days =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb957-5"><a href="n-parameters.html#cb957-5"></a><span class="st">  </span><span class="kw">select</span>(female_days, male_days) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb957-6"><a href="n-parameters.html#cb957-6"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> female_days<span class="op">:</span>male_days, </span>
<span id="cb957-7"><a href="n-parameters.html#cb957-7"></a>               <span class="dt">names_to =</span> <span class="st">"parameters"</span>,</span>
<span id="cb957-8"><a href="n-parameters.html#cb957-8"></a>               <span class="dt">values_to =</span> <span class="st">"days"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb957-9"><a href="n-parameters.html#cb957-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(days, <span class="dt">color =</span> parameters)) <span class="op">+</span></span>
<span id="cb957-10"><a href="n-parameters.html#cb957-10"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb957-11"><a href="n-parameters.html#cb957-11"></a><span class="st">     </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Probability Distribution"</span>,</span>
<span id="cb957-12"><a href="n-parameters.html#cb957-12"></a>         <span class="dt">subtitle =</span> <span class="st">"Men live longer"</span>,</span>
<span id="cb957-13"><a href="n-parameters.html#cb957-13"></a>         <span class="dt">x =</span> <span class="st">"Average Days Lived Post Election"</span>,</span>
<span id="cb957-14"><a href="n-parameters.html#cb957-14"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb957-15"><a href="n-parameters.html#cb957-15"></a><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb957-16"><a href="n-parameters.html#cb957-16"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span><span class="kw">percent_format</span>())</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-757-1.png" width="672"></p>
<!-- DK: Much more to say here, and say it clearly! -->
<p>The graph above displays the posterior probability distributions for <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(beta|2\)</span>. The two distributions are fairly different; the distribution for females is more spread out than that for males. A reason for this difference is because there were a greater number of men than women in the data. The more data we have, the more precise we can be.</p>
<p>Let’s now take a look at a posterior distribution for <span class="math inline">\(\beta_2\)</span>, the coefficient of <span class="math inline">\(alive\_pre_i\)</span>.</p>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="n-parameters.html#cb958-1"></a>fit_gov_<span class="dv">3</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb958-2"><a href="n-parameters.html#cb958-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb958-3"><a href="n-parameters.html#cb958-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(alive_pre)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb958-4"><a href="n-parameters.html#cb958-4"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">after_stat</span>(count<span class="op">/</span><span class="kw">sum</span>(count))),</span>
<span id="cb958-5"><a href="n-parameters.html#cb958-5"></a>                   <span class="dt">bins =</span> <span class="dv">100</span>, ) <span class="op">+</span></span>
<span id="cb958-6"><a href="n-parameters.html#cb958-6"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Distribution of the Coefficient of `alive_pre`"</span>,</span>
<span id="cb958-7"><a href="n-parameters.html#cb958-7"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>,</span>
<span id="cb958-8"><a href="n-parameters.html#cb958-8"></a>         <span class="dt">x =</span> <span class="st">"Coefficient of `alive_pre`"</span>)</span></code></pre></div>
<p><img src="book_temp_files/figure-html/fit_gov3-p1-1.png" width="672"></p>
<!-- DK: Show three posterior plots: one for beta_2, one for beta_0 (intercept) and one for beta_0 + beta_1.  Interpret them. This is a parallel slopes model. Can we show a parallel slopes graph by hand? Skip this for now. -->
<!-- DK: Cool, eh? It is (mostly?) an age effect! Controlling for age at the election, women live about as long as men, but they are much more likely be candidates as an older age. Again, what we are doing is slowly building more complex models, understanding what they mean. -->
<!-- Also, note that this is a "parallel slopes" model. Explain slowly what that means.  Create a plot. -->
<!-- Side note: I would have thought that overlapping CIs for male/female would equate to insignificance of sex dummy when the regression includes a intercept. But that does not seem to be the case. Am I missing something? -->
<!-- Make the graphic which shows two parallel lines, by calling two layers of geom_smooth().  -->
<!-- With this as warm-up, we are now in a position to explore interactions. -->
</div>
<div id="alive_pre-sex-and-alive_presex" class="section level3">
<h3>
<span class="header-section-number">9.3.4</span> alive_pre, sex and alive_pre*sex</h3>
<p>Let’s create another model. This time, however, the numerical outcome variable of alive_post as a function of the two explanatory variables we used above, <code>alive_pre</code> and <code>sex</code>, and of their interaction.</p>
<p>Here is the math we will be using:</p>
<p><span class="math display">\[ y_i =  \beta_0 + \beta_1 male_i + \beta_2 alive\_pre_i+ \beta_3 male_i *  alive\_pre_i + \epsilon_i\]</span></p>
<p>Ok, great! Now that we have our model, let’s break it down to explain what each part means. Note that a few of our meanings will be the same as our previous model above.</p>
<ul>
<li><p><span class="math inline">\(y_i\)</span>, our outcome variable, is still <span class="math inline">\(alive\_post_i\)</span>. We want to know how many days a candidate will live after an election.</p></li>
<li><p><span class="math inline">\(male_i\)</span> is still one of our explanatory variables. If we are predicting the amount of days a male candidate lives after the election, this value will be 1. When we are making this prediction for female candidate, this value will be 0. <span class="math inline">\(alive\_pre\)</span> is still our other explanatory variable that represents the number of days a candidate has lived before the election.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> is the average number of days lived after the election for women, who on the day of election, have been alive the average number of days of all female candidates. Note that this is different than our previous example where it was the average of all candidates. <span class="math inline">\(\beta_0\)</span> is also the intercept of the equation.</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> is the coefficient of <span class="math inline">\(alive\_pre_i\)</span>. It it just the slope for women. <strong>Note</strong>: in our last example, <span class="math inline">\(\beta_2\)</span> was the slope for the whole population. Now we are getting more specific.</p></li>
<li><p><span class="math inline">\(\beta_3\)</span> is difficult to interpret. However, when it is added to <span class="math inline">\(\beta_2\)</span>, the result in the slope for men.</p></li>
</ul>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="n-parameters.html#cb959-1"></a>fit_gov_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_gov,</span>
<span id="cb959-2"><a href="n-parameters.html#cb959-2"></a>                      <span class="dt">formula =</span> alive_post <span class="op">~</span><span class="st"> </span>sex<span class="op">*</span>alive_pre,</span>
<span id="cb959-3"><a href="n-parameters.html#cb959-3"></a>                      <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="n-parameters.html#cb960-1"></a><span class="kw">print</span>(fit_gov_<span class="dv">4</span>, <span class="dt">detail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##                   Median MAD_SD
## (Intercept)       5992.1 1335.4
## sexMale           4372.0 1344.0
## alive_pre           -0.1    0.4
## sexMale:alive_pre   -0.8    0.4
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 4040.2   85.1</code></pre>
<!-- DK: Take your time explaining what this means! It is not trivial. Note that this is a non-parallel slopes model. -->
<p>In this model, we can see that the intercept for women has increased. <span class="math inline">\(\beta_0\)</span> is 6008.4. This is the intercept for females. It still means the average number of days lived after the election for women is 6008.4. Our sexMale coefficient, <span class="math inline">\(\beta_1\)</span> refers to the value that must be added to (Intercept) in order to get the intercept for males. When calculated, i.e. 4332.1 + 6008.4, the result is 10340.5.</p>
<p>The coefficient for <span class="math inline">\(alive\_pre_i\)</span>, <span class="math inline">\(\beta_2\)</span> is -.1. What does this mean? It is the slope for only females. So for every extra day a feamle candidate is alive before an election, their lifespan after the election will be 0.1 days lower, on average. Now direct your attention below at the coefficient of sexMale:alive_pre, <span class="math inline">\(\beta_3\)</span>, which is -.8. This is the value that must be added to the coefficient of <span class="math inline">\(alive\_pre_i\)</span> (recall <span class="math inline">\(\beta_2\)</span> + <span class="math inline">\(\beta_3\)</span>) in order to find the slope for males. When the two are added together, this value, or slope, is -.9. This means for every extra day a male candidate is alive before an election, their lifespan after the election will be 0.9 days lower, on average.</p>
<p>Now let’s take a look at some posterior graphics:</p>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="n-parameters.html#cb962-1"></a>fit_gov_<span class="dv">4</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb962-2"><a href="n-parameters.html#cb962-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb962-3"><a href="n-parameters.html#cb962-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">male_days =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>sexMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb962-4"><a href="n-parameters.html#cb962-4"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">female_days =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb962-5"><a href="n-parameters.html#cb962-5"></a><span class="st">  </span><span class="kw">select</span>(female_days, male_days) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb962-6"><a href="n-parameters.html#cb962-6"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> female_days<span class="op">:</span>male_days, </span>
<span id="cb962-7"><a href="n-parameters.html#cb962-7"></a>               <span class="dt">names_to =</span> <span class="st">"parameters"</span>,</span>
<span id="cb962-8"><a href="n-parameters.html#cb962-8"></a>               <span class="dt">values_to =</span> <span class="st">"days"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb962-9"><a href="n-parameters.html#cb962-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(days, <span class="dt">color =</span> parameters)) <span class="op">+</span></span>
<span id="cb962-10"><a href="n-parameters.html#cb962-10"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb962-11"><a href="n-parameters.html#cb962-11"></a><span class="st">     </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Probability Distribution"</span>,</span>
<span id="cb962-12"><a href="n-parameters.html#cb962-12"></a>         <span class="dt">subtitle =</span> <span class="st">"Men live longer"</span>,</span>
<span id="cb962-13"><a href="n-parameters.html#cb962-13"></a>         <span class="dt">x =</span> <span class="st">"Average Days Lived Post Election"</span>,</span>
<span id="cb962-14"><a href="n-parameters.html#cb962-14"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb962-15"><a href="n-parameters.html#cb962-15"></a><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb962-16"><a href="n-parameters.html#cb962-16"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span><span class="kw">percent_format</span>())</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-760-1.png" width="672"></p>
<p>From this posterior for female an male intercepts (i. e. alive_post values), we are able to see that male candidates live longer on average than female candidates.</p>
<!-- how do I plot b2, and b2+b3 - put on same plot  -->
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb963-1"><a href="n-parameters.html#cb963-1"></a>fit_gov_<span class="dv">4</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb963-2"><a href="n-parameters.html#cb963-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb963-3"><a href="n-parameters.html#cb963-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">slope_men =</span> alive_pre <span class="op">+</span><span class="st"> `</span><span class="dt">sexMale:alive_pre</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb963-4"><a href="n-parameters.html#cb963-4"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">slope_women =</span> alive_pre) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb963-5"><a href="n-parameters.html#cb963-5"></a><span class="st">  </span><span class="kw">select</span>(slope_women, slope_men) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb963-6"><a href="n-parameters.html#cb963-6"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> slope_women<span class="op">:</span>slope_men, </span>
<span id="cb963-7"><a href="n-parameters.html#cb963-7"></a>               <span class="dt">names_to =</span> <span class="st">"parameters"</span>,</span>
<span id="cb963-8"><a href="n-parameters.html#cb963-8"></a>               <span class="dt">values_to =</span> <span class="st">"slope"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb963-9"><a href="n-parameters.html#cb963-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(slope, <span class="dt">color =</span> parameters)) <span class="op">+</span></span>
<span id="cb963-10"><a href="n-parameters.html#cb963-10"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb963-11"><a href="n-parameters.html#cb963-11"></a><span class="st">     </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Probability Distribution"</span>,</span>
<span id="cb963-12"><a href="n-parameters.html#cb963-12"></a>         <span class="dt">subtitle =</span> <span class="st">"Men have a steeper slope"</span>,</span>
<span id="cb963-13"><a href="n-parameters.html#cb963-13"></a>         <span class="dt">x =</span> <span class="st">"slope"</span>,</span>
<span id="cb963-14"><a href="n-parameters.html#cb963-14"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb963-15"><a href="n-parameters.html#cb963-15"></a><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb963-16"><a href="n-parameters.html#cb963-16"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span><span class="kw">percent_format</span>())</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-761-1.png" width="672"></p>
<p>This posterior distribution shows the average slope values for men and women. You can see that men have a steeper slope, while the slop for women is practically 0!</p>
</div>
<div id="state-alive_pre-sex-and-alive_presex" class="section level3">
<h3>
<span class="header-section-number">9.3.5</span> state, alive_pre, sex and alive_pre*sex</h3>
<p>Our last model will be very similar to the one we just created. However, we are now adding “state”, which will give us 55 different intercepts!</p>
<p>Here’s the math we will be using:</p>
<p><span class="math display">\[ y_i =  \beta_0 +  \beta_1 x_{AK,i} + \beta_1 x_{AR,i} + ... \beta_{49} x_{WY,i} + \beta_{50} male_i + \beta_{51} alive\_pre_i+ \beta_{52} male_i *  alive\_pre_i + \epsilon_i\]</span></p>
<ul>
<li>
<span class="math inline">\(y_i\)</span> is still alive_post. <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>, <span class="math inline">\(\beta_3\)</span>… all the way to <span class="math inline">\(\beta_49\)</span> correspond to different values. These values are specific to each state. In order to find the female intercept (i.e. alive_post for females) for a specific state, you must add that state’s beta value to the value of <span class="math inline">\(\beta_0\)</span> to find intercept for the alive_post outcome for females candidates in that specific state. For example, if you look at the model above, <span class="math inline">\(\beta_1\)</span> is the intercept value for Arkansas (note the AK subscript). You would add whatever value this is, which appears next to Arkansas in the printed model, and add it to the value for <span class="math inline">\(\beta_0\)</span>.</li>
</ul>
<p>*<span class="math inline">\(\beta_0\)</span> will be the intercept for a state alone. When the model is printed, you will see that (Intercept) takes on the alive_post value for female candidates in Alabama.</p>
<p>*<span class="math inline">\(\beta_50\)</span> is the coefficient for the explanatory variable <span class="math inline">\(male_i\)</span>. When we are trying to find the intercepts for female candidates, the explanatory variable still takes on the value of 0. However, <span class="math inline">\(male_i\)</span> = 1 when we are trying to find intercept values for male candidates. Therefore, you add the <span class="math inline">\(\beta_50\)</span> value to the female intercept value to find the value of alive_post for male candidates. <span class="math inline">\(\beta_51\)</span> is the coefficient for the explanatory variable <span class="math inline">\(alive\_pre_i\)</span>. It it just the slope for women. <span class="math inline">\(\beta_52\)</span> is insignificant. However, it gains meaning when it is added to <span class="math inline">\(\beta_51\)</span>, which results in the slope for men.</p>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="n-parameters.html#cb964-1"></a>fit_gov_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_gov,</span>
<span id="cb964-2"><a href="n-parameters.html#cb964-2"></a>                      <span class="dt">formula =</span> alive_post <span class="op">~</span><span class="st"> </span>state <span class="op">+</span><span class="st"> </span>sex<span class="op">*</span>alive_pre,</span>
<span id="cb964-3"><a href="n-parameters.html#cb964-3"></a>                      <span class="dt">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb964-4"><a href="n-parameters.html#cb964-4"></a>                      <span class="dt">iter =</span> <span class="dv">10000</span>)</span></code></pre></div>
<p>Note it takes awhile to run. We are dealing with 55 parameters here.</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="n-parameters.html#cb965-1"></a><span class="kw">print</span>(fit_gov_<span class="dv">5</span>, <span class="dt">detail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##                     Median  MAD_SD 
## (Intercept)          4855.9  1511.5
## stateAlaska          1134.9  1399.6
## stateArizona         2947.5  1112.5
## stateArkansas         570.0  1148.2
## stateCalifornia      2045.8  1216.3
## stateColorado        1515.9  1190.0
## stateConnecticut     1068.3  1206.0
## stateDelaware        3166.9  1273.2
## stateFlorida        -1514.8  1338.3
## stateGeorgia         1825.4  1406.4
## stateHawaii          1624.9  1524.8
## stateIdaho           1754.0  1212.0
## stateIllinois        -127.9  1310.2
## stateIndiana         1297.2  1226.8
## stateIowa             975.3  1141.4
## stateKansas          -110.9  1157.5
## stateKentucky        1514.2  1266.2
## stateLouisiana       1467.7  1452.9
## stateMaine           2165.1  1290.6
## stateMaryland        1698.3  1210.0
## stateMassachusetts    138.8  1146.2
## stateMichigan       -1111.2  1174.1
## stateMinnesota       1682.4  1134.5
## stateMississippi      826.2  1290.9
## stateMissouri         528.3  1291.9
## stateMontana          891.0  1256.6
## stateNebraska         848.1  1175.4
## stateNevada          1559.3  1330.0
## stateNew Hampshire   1343.3  1126.2
## stateNew Jersey       413.9  1268.8
## stateNew Mexico      1061.9  1108.2
## stateNew York         914.8  1189.1
## stateNorth Carolina -1407.0  1400.1
## stateNorth Dakota    2197.6  1172.5
## stateOhio            2234.3  1175.5
## stateOklahoma        -522.8  1318.2
## stateOregon           248.5  1240.9
## statePennsylvania    1304.7  1257.6
## stateRhode Island    1985.7  1069.4
## stateSouth Carolina  2503.8  1341.5
## stateSouth Dakota   -1807.4  1106.6
## stateTennessee       -408.0  1255.7
## stateTexas           1226.2  1123.2
## stateUtah            1239.4  1225.4
## stateVermont          588.7  1140.1
## stateVirginia        2611.0  1398.3
## stateWashington      2791.2  1271.1
## stateWest Virginia   2425.3  1257.1
## stateWisconsin       2487.2  1115.5
## stateWyoming         -501.7  1229.3
## sexMale              4420.2  1328.4
## alive_pre              -0.1     0.4
## sexMale:alive_pre      -0.8     0.4
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 3959.6   86.2</code></pre>
<p>The (Intercept) refers to the average number of days lived after the election for women, who on the day of election, have been alive the average number of days of all female candidates in Alabama! That’s a mouthful. It really is not different than what we have been doing all along, however. You can see here that (Intercept) value, 4910.4.</p>
<p>However, we have only talked about women. What about for the men? Well, if you look at the bottom of the list, you will see the sexMale value 4410.1. When you wish to find alive_post for a specific state, you must add this value to the (Intercept), 4910.4, and then add the intercept of the desired state.</p>
<p><span class="math inline">\(\beta_51\)</span>, our coefficient value for <span class="math inline">\(alive\_pre_i\)</span>, is 0. This means women have a slope of 0.</p>
<!-- DK: Conflict between $alive\_pre_i$ and `sexMale:alive_pre`. Which is better? Should be consistent. -->
<p><span class="math inline">\(\beta_51\)</span> + <span class="math inline">\(\beta_52\)</span>, our coefficients for <span class="math inline">\(alive\_pre_i\)</span> and <code>sexMale:alive_pre</code>, results in the value of around -0.8. This value is our slope for men.</p>
<p>Let’s take a look at the posterior distribution for women in Washington and South Dakota.</p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="n-parameters.html#cb967-1"></a>fit_gov_<span class="dv">5</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb967-2"><a href="n-parameters.html#cb967-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb967-3"><a href="n-parameters.html#cb967-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Washington_females =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span><span class="fl">2739.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb967-4"><a href="n-parameters.html#cb967-4"></a><span class="st">  </span><span class="kw">mutate</span> (<span class="dt">SD_females =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span><span class="op">-</span><span class="fl">1869.4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb967-5"><a href="n-parameters.html#cb967-5"></a><span class="st">  </span><span class="kw">select</span>(Washington_females, SD_females) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb967-6"><a href="n-parameters.html#cb967-6"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> Washington_females<span class="op">:</span>SD_females, </span>
<span id="cb967-7"><a href="n-parameters.html#cb967-7"></a>               <span class="dt">names_to =</span> <span class="st">"parameters"</span>,</span>
<span id="cb967-8"><a href="n-parameters.html#cb967-8"></a>               <span class="dt">values_to =</span> <span class="st">"days"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb967-9"><a href="n-parameters.html#cb967-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(days, <span class="dt">color =</span> parameters)) <span class="op">+</span></span>
<span id="cb967-10"><a href="n-parameters.html#cb967-10"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb967-11"><a href="n-parameters.html#cb967-11"></a><span class="st">     </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Probability Distribution"</span>,</span>
<span id="cb967-12"><a href="n-parameters.html#cb967-12"></a>         <span class="dt">subtitle =</span> <span class="st">"for women that live in Washington and South Dakota"</span>,</span>
<span id="cb967-13"><a href="n-parameters.html#cb967-13"></a>         <span class="dt">x =</span> <span class="st">"Average Days Lived Post Election"</span>,</span>
<span id="cb967-14"><a href="n-parameters.html#cb967-14"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb967-15"><a href="n-parameters.html#cb967-15"></a><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb967-16"><a href="n-parameters.html#cb967-16"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span><span class="kw">percent_format</span>())</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-764-1.png" width="672"></p>
<p>The posterior above shows that female candidates in Washington live longer after the election than female candidates in South Dakota. Interesting huh? You can see here our knowledge of average is always more precise than our knowledge of individuals.</p>
<!-- DK: Need to modify this to only show one of the more interesting state coefficients. (Although we might show all the state pdfs in the graphic.) This a good place to discuss shrinkage, which is what is happening here. And that is probably enough models. -->
</div>
</div>
<div id="temperance" class="section level2">
<h2>
<span class="header-section-number">9.4</span> Temperance</h2>
<p>Temperance is our final guidance tool. In the world, we are constantly adapting to new things being thrown our way. It is impossible to have explanations for everything because there will always be the “unknowns”. There is no model that exists that can replicate the world perfectly. We remind ourselves of the “unknowns” so we can be humble with the conclusions we gather from our data.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:unnamed-chunk-765"></span>
<img src="other/images/Temperance.jpg" alt="Temperance" width="960"><!--
<p class="caption marginnote">-->FIGURE 9.4: Temperance<!--</p>-->
<!--</div>--></span>
</p>
<p>Now, let’s build a model to answer the following question:</p>
<p><em>How do the alive_post values vary for two male individuals, from South Dakota and Washington, who both have the same pre_alive values?</em></p>
<p>First, we create a tibble with the desired input for our model. In our case the tibble has a variable named “sex” which contains ten observations all with the same value “Male”. Next, we’ll use the posterior_predict() function to get some simulation results. posterior_predict() takes two arguments: the model for which the simulations should be run, and a tibble indicating for which and how many parameters we want to run these simulations. In this case, we are using the fit_gov_5 model and the tibble is the one we just created.</p>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb968-1"><a href="n-parameters.html#cb968-1"></a>new_obs &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">"Male"</span>, <span class="st">"Male"</span>),</span>
<span id="cb968-2"><a href="n-parameters.html#cb968-2"></a>       <span class="dt">state =</span> <span class="kw">c</span>(<span class="st">"South Dakota"</span>, <span class="st">"Washington"</span>),<span class="dt">alive_pre =</span> <span class="dv">10</span><span class="op">*</span><span class="dv">365</span>)</span>
<span id="cb968-3"><a href="n-parameters.html#cb968-3"></a></span>
<span id="cb968-4"><a href="n-parameters.html#cb968-4"></a>pp &lt;-<span class="st"> </span><span class="kw">posterior_predict</span>(fit_gov_<span class="dv">5</span>, <span class="dt">newdata =</span> new_obs) <span class="op">%&gt;%</span></span>
<span id="cb968-5"><a href="n-parameters.html#cb968-5"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb968-6"><a href="n-parameters.html#cb968-6"></a><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">everything</span>(), as.numeric))</span>
<span id="cb968-7"><a href="n-parameters.html#cb968-7"></a>  </span>
<span id="cb968-8"><a href="n-parameters.html#cb968-8"></a><span class="kw">head</span>(pp, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##      `1`    `2`
##    &lt;dbl&gt;  &lt;dbl&gt;
##  1 3663. 14462.
##  2  984. 11595.
##  3 7043. 10203.
##  4 4077. 11052.
##  5 1161.  9364.
##  6 2760.  4199.
##  7 6416. 12433.
##  8  499.  -414.
##  9 -329.  3900.
## 10 5945.  6996.</code></pre>
<p>If you look above, you will see that we have 2 columns (one for each person).
The first column shows the posterior predictions for male from South Dakota, whose age is 10x the average of all candidates. The second column shows the posterior predictions for male from Washington, whose age is 10x the average of all candidates.</p>
<p>Now let’s plot the individual posteriors.</p>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb970-1"><a href="n-parameters.html#cb970-1"></a>fit_gov_<span class="dv">5</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-2"><a href="n-parameters.html#cb970-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-3"><a href="n-parameters.html#cb970-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Washington_male =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span><span class="fl">2739.1</span> <span class="op">+</span><span class="st"> </span>sexMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-4"><a href="n-parameters.html#cb970-4"></a><span class="st">  </span><span class="kw">mutate</span> (<span class="dt">SD_male =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span><span class="op">-</span><span class="fl">1842.9</span> <span class="op">+</span>sexMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-5"><a href="n-parameters.html#cb970-5"></a><span class="st">  </span><span class="kw">select</span>(Washington_male, SD_male) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-6"><a href="n-parameters.html#cb970-6"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> Washington_male<span class="op">:</span>SD_male, </span>
<span id="cb970-7"><a href="n-parameters.html#cb970-7"></a>               <span class="dt">names_to =</span> <span class="st">"parameters"</span>,</span>
<span id="cb970-8"><a href="n-parameters.html#cb970-8"></a>               <span class="dt">values_to =</span> <span class="st">"days"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb970-9"><a href="n-parameters.html#cb970-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(days, <span class="dt">color =</span> parameters)) <span class="op">+</span></span>
<span id="cb970-10"><a href="n-parameters.html#cb970-10"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb970-11"><a href="n-parameters.html#cb970-11"></a><span class="st">     </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Probability Distribution"</span>,</span>
<span id="cb970-12"><a href="n-parameters.html#cb970-12"></a>         <span class="dt">subtitle =</span> <span class="st">"for men from Washington and South Dakota"</span>,</span>
<span id="cb970-13"><a href="n-parameters.html#cb970-13"></a>         <span class="dt">x =</span> <span class="st">"Average Days Lived Post Election"</span>,</span>
<span id="cb970-14"><a href="n-parameters.html#cb970-14"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb970-15"><a href="n-parameters.html#cb970-15"></a><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb970-16"><a href="n-parameters.html#cb970-16"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span><span class="kw">percent_format</span>())</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-767-1.png" width="672"></p>
<p>Looking at our posterior above, we can see that the male candidate from Washington is expected to live longer. Ok great, but how much longer?</p>
<p><em>How do the alive_post values vary for two male individuals, from South Dakota and Washington, who both have the same pre_alive values?</em></p>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="n-parameters.html#cb971-1"></a>pp <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb971-2"><a href="n-parameters.html#cb971-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff=</span> <span class="st">`</span><span class="dt">2</span><span class="st">`</span><span class="op">-</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb971-3"><a href="n-parameters.html#cb971-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(diff)) <span class="op">+</span></span>
<span id="cb971-4"><a href="n-parameters.html#cb971-4"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb971-5"><a href="n-parameters.html#cb971-5"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Probability Distribution"</span>, </span>
<span id="cb971-6"><a href="n-parameters.html#cb971-6"></a>         <span class="dt">subtitle =</span> <span class="st">"How much longer?"</span>,</span>
<span id="cb971-7"><a href="n-parameters.html#cb971-7"></a>         <span class="dt">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb971-8"><a href="n-parameters.html#cb971-8"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>) <span class="op">+</span></span>
<span id="cb971-9"><a href="n-parameters.html#cb971-9"></a><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">percent_format</span>())</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-768-1.png" width="672">
In words, we would expect the male candidate from Washington to live longer than the South Dakota male. By how much? Well, that number is an unknown parameter. By looking at our posterior above, our best estimate is about 3,000 days, which is roughly 8 years. However, it is important to note that it is possible that the male from South Dakota could outlive the Washington male. IN fact, there is a 1/3 chance.</p>
<p>Also, notice that in this distribution there are alive_post values that are negative? Does this make sense? Could a candidate be alive negative days after the election/ The answer is no. However, nothing is wrong with the code. The reason for this is because when we assumed epsilon was normally distributed, we allowed numbers to be negative. This is not that important, so let’s press on.</p>
<p>First, we create a tibble with the desired input for our model. In our case the tibble has a variable named “sex” which contains ten observations all with the same value “Male”. Next, we’ll use the posterior_predict() function to get some simulation results. posterior_predict() takes two arguments: the model for which the simulations should be run, and a tibble indicating for which and how many parameters we want to run these simulations. In this case, we are using the fit_gov_5 model and the tibble is the one we just created.</p>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb972-1"><a href="n-parameters.html#cb972-1"></a>new_obs &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">"Male"</span>, <span class="st">"Male"</span>),</span>
<span id="cb972-2"><a href="n-parameters.html#cb972-2"></a>       <span class="dt">state =</span> <span class="kw">c</span>(<span class="st">"South Dakota"</span>, <span class="st">"Washington"</span>),<span class="dt">alive_pre =</span> <span class="dv">10</span><span class="op">*</span><span class="dv">365</span>)</span>
<span id="cb972-3"><a href="n-parameters.html#cb972-3"></a></span>
<span id="cb972-4"><a href="n-parameters.html#cb972-4"></a>pp &lt;-<span class="st"> </span><span class="kw">posterior_predict</span>(fit_gov_<span class="dv">5</span>, <span class="dt">newdata =</span> new_obs) <span class="op">%&gt;%</span></span>
<span id="cb972-5"><a href="n-parameters.html#cb972-5"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb972-6"><a href="n-parameters.html#cb972-6"></a><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">everything</span>(), as.numeric))</span>
<span id="cb972-7"><a href="n-parameters.html#cb972-7"></a>  </span>
<span id="cb972-8"><a href="n-parameters.html#cb972-8"></a><span class="kw">head</span>(pp, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##       `1`    `2`
##     &lt;dbl&gt;  &lt;dbl&gt;
##  1  4272. 11804.
##  2  1252. 13982.
##  3  5757.  1168.
##  4  2738.  8946.
##  5  6923.  4746.
##  6  5560.  9958.
##  7  2582. 12381.
##  8  -346.  7539.
##  9 -1205.  9820.
## 10  7350.  2512.</code></pre>
<p>If you look above, you will see that we have 2 columns (one for each person).
The first column shows the posterior predictions for male from South Dakota, whose age is 10x the average of all candidates. The second column shows the posterior predictions for male from Washington, whose age is 10x the average of all candidates.</p>
<p>Now let’s plot the individual posteriors.</p>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="n-parameters.html#cb974-1"></a>fit_gov_<span class="dv">5</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb974-2"><a href="n-parameters.html#cb974-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb974-3"><a href="n-parameters.html#cb974-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Washington_male =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span><span class="fl">2739.1</span> <span class="op">+</span><span class="st"> </span>sexMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb974-4"><a href="n-parameters.html#cb974-4"></a><span class="st">  </span><span class="kw">mutate</span> (<span class="dt">SD_male =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span><span class="op">-</span><span class="fl">1842.9</span> <span class="op">+</span>sexMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb974-5"><a href="n-parameters.html#cb974-5"></a><span class="st">  </span><span class="kw">select</span>(Washington_male, SD_male) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb974-6"><a href="n-parameters.html#cb974-6"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> Washington_male<span class="op">:</span>SD_male, </span>
<span id="cb974-7"><a href="n-parameters.html#cb974-7"></a>               <span class="dt">names_to =</span> <span class="st">"parameters"</span>,</span>
<span id="cb974-8"><a href="n-parameters.html#cb974-8"></a>               <span class="dt">values_to =</span> <span class="st">"days"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb974-9"><a href="n-parameters.html#cb974-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(days, <span class="dt">color =</span> parameters)) <span class="op">+</span></span>
<span id="cb974-10"><a href="n-parameters.html#cb974-10"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb974-11"><a href="n-parameters.html#cb974-11"></a><span class="st">     </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Probability Distribution"</span>,</span>
<span id="cb974-12"><a href="n-parameters.html#cb974-12"></a>         <span class="dt">subtitle =</span> <span class="st">"for men from Washington and South Dakota"</span>,</span>
<span id="cb974-13"><a href="n-parameters.html#cb974-13"></a>         <span class="dt">x =</span> <span class="st">"Average Days Lived Post Election"</span>,</span>
<span id="cb974-14"><a href="n-parameters.html#cb974-14"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb974-15"><a href="n-parameters.html#cb974-15"></a><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb974-16"><a href="n-parameters.html#cb974-16"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span><span class="kw">percent_format</span>())</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-770-1.png" width="672"></p>
<p>Looking at our posterior above, we can see that the male candidate from Washington is expected to live longer. Ok great, but how much longer?</p>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="n-parameters.html#cb975-1"></a>pp <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb975-2"><a href="n-parameters.html#cb975-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff=</span> <span class="st">`</span><span class="dt">2</span><span class="st">`</span><span class="op">-</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb975-3"><a href="n-parameters.html#cb975-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(diff)) <span class="op">+</span></span>
<span id="cb975-4"><a href="n-parameters.html#cb975-4"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb975-5"><a href="n-parameters.html#cb975-5"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Posterior Probability Distribution"</span>, </span>
<span id="cb975-6"><a href="n-parameters.html#cb975-6"></a>         <span class="dt">subtitle =</span> <span class="st">"How much longer?"</span>,</span>
<span id="cb975-7"><a href="n-parameters.html#cb975-7"></a>         <span class="dt">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb975-8"><a href="n-parameters.html#cb975-8"></a>         <span class="dt">y =</span> <span class="st">"Probability"</span>) <span class="op">+</span></span>
<span id="cb975-9"><a href="n-parameters.html#cb975-9"></a><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">percent_format</span>())</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-771-1.png" width="672">
In words, we would expect the male candidate from Washington to live longer than the South Dakota male. By how much? Well, that number is an unknown parameter. By looking at our posterior above, our best estimate is about 3,000 days, which is roughly 8 years. However, it is important to note that it is possible that the male from South Dakota could outlive the Washington male. IN fact, there is a 1/3 chance.</p>
<p>Also, notice that in this distribution there are alive_post values that are negative? Does this make sense? Could a candidate be alive negative days after the election/ The answer is no. However, nothing is wrong with the code. The reason for this is because when we assumed epsilon was normally distributed, we allowed numbers to be negative. This is not that important, so let’s press on.</p>
</div>
<div id="eda-of-shaming" class="section level2">
<h2>
<span class="header-section-number">9.5</span> EDA of <code>shaming</code>
</h2>
<div id="gov-50-stop-here-rest-of-the-chapter-is-a-draft-which-we-will-go-over-in-class.-tutorial-9-only-covers-material-in-first-part-of-the-chapter." class="section level3">
<h3>
<span class="header-section-number">9.5.1</span> GOV 50: STOP HERE! Rest of the chapter is a draft, which we will go over in class. Tutorial 9 only covers material in first part of the chapter.</h3>
<!-- Use print(fit_obj, digits = 4) if you need to see more digits. -->
<p>Imagine you are running for Governor and want to do a better job of getting your voters to vote. You recently read about a large-scale experiment showing the effect of sending out a voting reminder that “shames” citizens who do not vote. You are considering sending out a “shaming” voting reminder yourself. What will happen if you do? Will more voters show up to the polls? Additionally, on the day of the election a female citizen is randomly selected. What is the probability she will vote?</p>
<p>Consider a new data set, <code>shaming</code>, corresponding to an experiment carried out by Gerber, Green, and Larimer (2008) titled “Social Pressure and Voter Turnout: Evidence from a Large-Scale Field Experiment”. This experiment used several hundred thousand registered voters and a series of mailings to determine the effect of social pressure on voter turnout.</p>
<p>Let’s now do another EDA, starting off by running <code>glimpse()</code>.</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="n-parameters.html#cb976-1"></a><span class="kw">glimpse</span>(shaming)</span></code></pre></div>
<pre><code>## Rows: 344,084
## Columns: 10
## $ sex         &lt;chr&gt; "Male", "Female", "Male", "Female", "Female", "Male", "Fe…
## $ birth_year  &lt;int&gt; 1941, 1947, 1951, 1950, 1982, 1981, 1959, 1956, 1968, 196…
## $ primary_02  &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "No", "Yes", "Yes", "Y…
## $ general_02  &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "No", "Yes", "Yes", "N…
## $ primary_04  &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No", "No", "No…
## $ general_04  &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "…
## $ treatment   &lt;fct&gt; Civic Duty, Civic Duty, Hawthorne, Hawthorne, Hawthorne, …
## $ primary_06  &lt;int&gt; 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, …
## $ hh_size     &lt;int&gt; 2, 2, 3, 3, 3, 3, 3, 3, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 1, …
## $ no_of_names &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
<p>Here we see that <code>glimpse()</code> gives us a look at the raw data contained within the <code>shaming</code> data set. At the very top of the output, we can see the number of rows and columns, or observations and variables respectively. We see that there are 344,084 observations, with each row corresponding to a unique respondent. The “Columns: 10” tells us that there are 10 variables within this data set. Below this, we see a cutoff version of the entire data set that has the variables on the left as rows and the observations as a list separated by commas, as compared to the tibble output that presents with the variables as columns and the observations as rows running horizontally.</p>
<p>From this summary, we get an idea of some of the variables we will be working with. Variables of particular interest to us are <code>sex</code>, <code>hh_size</code>, and <code>primary_06</code>. The variable <code>hh_size</code> tells us the size of the respondent’s household, <code>sex</code> tells us the sex of the respondent, and <code>primary_06</code> tells us whether or not the respondent voted in the 2006 Primary election.</p>
<p>There are a few things to note while exploring this data set. You may – or may not – have noticed that the only response to the <code>general_04</code> variable is “Yes”. In their published article, the authors note that “Only registered voters who voted in November 2004 were selected for our sample” (Gerber, Green, Larimer, 2008). After this, the authors found their history then sent out the mailings.</p>
<p>It is also important to identify the dependent variable and its meaning. In this shaming experiment, the dependent variable is <code>primary_06</code>, which is a variable coded either 0 or 1 for whether or not the respondent voted in the 2006 primary election. This is the dependent variable because the authors are trying to measure the effect that the treatments have on the proportion of people who vote in the 2006 general election.</p>
<!-- HV: Should I include discussion of the left-hand variable (treatment?) here? Or wait until we move into the regressions? -->
<p>The voting results from other years, such as 2002 and 2004, are of less interest to us and can be removed from the abbreviated data set. In addition to removing <code>general_04</code>, <code>primary_02</code>, <code>general_02</code>, or <code>primary_04</code>, we also will not be taking particular interest in <code>birth_year</code>, or <code>no_of_names</code> within this chapter.</p>
<!-- HV: should I explain why we are not using any of these variables? why they are not of great use to us? -->
<p>By narrowing down the set of variables we are looking at and investigating, we will find more meaningful relationships among them. However, we have not yet discussed the most important variable of them all: <code>treatment</code>. The <code>treatment</code> variable is a factor variable with 5 levels, including the control. Since we are curious as to how sending mailings affects voter turnout, the treatment variable will tell us about the impact each type of mailing can make. Let’s start off by taking a broad look at the different treatments.
<!-- HV: Is it okay to say the first sentence of this paragraph? --></p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="n-parameters.html#cb978-1"></a>shaming <span class="op">%&gt;%</span></span>
<span id="cb978-2"><a href="n-parameters.html#cb978-2"></a><span class="st">  </span><span class="kw">count</span>(treatment)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   treatment       n
##   &lt;fct&gt;       &lt;int&gt;
## 1 Civic Duty  38218
## 2 Hawthorne   38204
## 3 Control    191243
## 4 Self        38218
## 5 Neighbors   38201</code></pre>
<p>Four types of treatments were used in the experiment, with voters receiving one of the four types of mailing. All of the mailing treatments carried the message, “DO YOUR CIVIC DUTY - VOTE!”.</p>
<p>The first treatment, Civic Duty, also read, “Remember your rights and responsibilities as a citizen. Remember to vote.” This message acted as a baseline for the other treatments, since it carried a message very similar to the one displayed on all the mailings.</p>
<p>In the second treatment, Hawthorne, households received a mailing which told the voters that they were being studied and their voting behavior would be examined through public records. This adds a small amount of social pressure to the households receiving this mailing.</p>
<p>In the third treatment, Self, the mailing includes the recent voting record of each member of the household, placing the word “Voted” next to their name if they did in fact vote in the 2004 election or a blank space next to the name if they did not. In this mailing, the households were also told, “we intend to mail an updated chart” with the voting record of the household members after the 2006 primary. By emphasizing the public nature of voting records, this type of mailing exerts more social pressure on voting than the Hawthorne treatment.</p>
<p>The fourth treatment, Neighbors, provides the household members’ voting records, as well as the voting records of those who live nearby. This mailing also told recipients, “we intend to mail an updated chart” of who voted in the 2006 election to the entire neighborhood.</p>
<p>For now, let’s focus on a subset of the data. We will sample just 10,000 rows because otherwise <code>stan_glm()</code> takes an annoyingly large amount of time to work. Nothing substantive changes.</p>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="n-parameters.html#cb980-1"></a><span class="kw">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb980-2"><a href="n-parameters.html#cb980-2"></a>ch9_sham &lt;-<span class="st"> </span>shaming <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb980-3"><a href="n-parameters.html#cb980-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">solo =</span> <span class="kw">ifelse</span>(hh_size <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb980-4"><a href="n-parameters.html#cb980-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age =</span> <span class="dv">2006</span> <span class="op">-</span><span class="st"> </span>birth_year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb980-5"><a href="n-parameters.html#cb980-5"></a><span class="st">  </span><span class="kw">select</span>(primary_<span class="dv">06</span>, treatment, solo, sex, age) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb980-6"><a href="n-parameters.html#cb980-6"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">10000</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>We create the variable <code>solo</code>, which is TRUE for voters who live alone and FALSE for those that do not. We are curious to see if the treatment effect, if any, is the same for voters who live alone as it is for those who do not.</p>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb981-1"><a href="n-parameters.html#cb981-1"></a>ch9_sham <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb981-2"><a href="n-parameters.html#cb981-2"></a><span class="st">  </span><span class="kw">skim</span>()</span></code></pre></div>
<p><!--
<caption>--><span class="marginnote shownote"><span id="tab:unnamed-chunk-775">TABLE 9.2: </span>Data summary</span><!--</caption>--></p>
<table><tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">10000</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">factor</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">logical</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody></table>
<p><strong>Variable type: character</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr></tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">ordered</th>
<th align="right">n_unique</th>
<th align="left">top_counts</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">treatment</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">5</td>
<td align="left">Con: 5594, Sel: 1135, Haw: 1110, Civ: 1108</td>
</tr></tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="left">count</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">solo</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.15</td>
<td align="left">FAL: 8532, TRU: 1468</td>
</tr></tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">primary_06</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.32</td>
<td align="right">0.47</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">49.86</td>
<td align="right">14.54</td>
<td align="right">20</td>
<td align="right">41</td>
<td align="right">50</td>
<td align="right">59</td>
<td align="right">99</td>
<td align="left">▃▇▇▂▁</td>
</tr>
</tbody>
</table>
<p>Let’s focus on a few observations that may be relevant to our analysis. First, note that each treatment has approximately 38,000 respondents. The control group, denoted by Con, has approximately 190 thousand respondents. For the logical variable <code>solo</code>, we see that approximately 47 thousand of the total respondents live alone (TRUE), while approximately 296 thousand live in households greater than 1 (FALSE). It may also be important to note that the average age of the respondents is 49.8 years with a standard deviation of 14.4 years.</p>
<!-- DK: Add discussion of what you see here. No need to drop missing values since there aren't any. I think this next discussion can be dropped. -->
<p>To get a better sense of some respondents’ information, let’s use <code>sample_n()</code> to gather a random sample of <em>n</em> observations from the data set.</p>
<!-- HV: Does this belong here? -->
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb982-1"><a href="n-parameters.html#cb982-1"></a>ch9_sham <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb982-2"><a href="n-parameters.html#cb982-2"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##    primary_06 treatment solo  sex      age
##         &lt;int&gt; &lt;fct&gt;     &lt;lgl&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1          0 Hawthorne FALSE Male      20
##  2          0 Neighbors FALSE Male      53
##  3          0 Control   FALSE Female    45
##  4          1 Neighbors FALSE Female    44
##  5          0 Control   FALSE Female    50
##  6          0 Control   FALSE Female    45
##  7          0 Neighbors TRUE  Female    41
##  8          0 Self      FALSE Male      32
##  9          0 Hawthorne FALSE Female    58
## 10          1 Control   FALSE Female    75</code></pre>
<p>Now we have a table with 5 random observations and the respondents’ information in a regular table output. By taking a few random samples, we may start to see some patterns within the data. Do you notice anything in particular about the variable <code>treatment</code>?</p>
<p>One other helpful summarizing technique we can use is <code>skim()</code>. To make the information it contains simpler, we will only be looking at three variables: <code>primary_06</code>, <code>treatment</code>, and <code>sex</code>.</p>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="n-parameters.html#cb984-1"></a>shaming <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb984-2"><a href="n-parameters.html#cb984-2"></a><span class="st">  </span><span class="kw">select</span>(primary_<span class="dv">06</span>, treatment, sex) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb984-3"><a href="n-parameters.html#cb984-3"></a><span class="st">  </span><span class="kw">skim</span>()</span></code></pre></div>
<p><!--
<caption>--><span class="marginnote shownote"><span id="tab:unnamed-chunk-777">TABLE 9.3: </span>Data summary</span><!--</caption>--></p>
<table><tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">344084</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">factor</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody></table>
<p><strong>Variable type: character</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr></tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">ordered</th>
<th align="right">n_unique</th>
<th align="left">top_counts</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">treatment</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">5</td>
<td align="left">Con: 191243, Civ: 38218, Sel: 38218, Haw: 38204</td>
</tr></tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">primary_06</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.32</td>
<td align="right">0.46</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">▇▁▁▁▃</td>
</tr></tbody>
</table>
<p>Running the <code>skim()</code> command gives us a summary of the data set as a whole, as well as the types of variables and individual variable summaries. At the top, we see the number of columns and rows within the selected data set. Below this we are given a list with the different types of variables, or columns, and how often they appear within the data we are skimming. The variables are then separated by their column type, and we are given individual summaries based on the type.</p>
<!-- 2) `primary_06` as a function of `treatment` and `solo` and of their interaction. We will build up this model step-by-step, very similar to how we explored the effect of treatment in chapter 8. But we go deeper because  we are learning about interactions. Key thing is to go through all the themes.Rmd issues, at least until prediction. Note that this situation is different from Chapter 8 in that fitted values and predicted values are not the same thing! The fitted value, for a combination of values for treatment and solo, is something 0.30, meaning that 30% of the people in this bucket votes. But the predicted value must be 0 or 1. Either you voted or you didn't. This example is clearly causal and so you need a Rubin Table with 4 potential outcome columns. The key difference in this chapter is that we are using lots of right hand side variables, both continuous and discrete. -->
<p>Having created models with one parameter in Chapter <a href="one-parameter.html#one-parameter">6</a> and two parameters in Chapter <a href="two-parameters.html#two-parameters">7</a>, you are now ready to make the jump to <span class="math inline">\(N\)</span> parameters. The more parameters we include in our models, the more flexible they can become. But we must be careful of <em>overfitting</em>, of making models which are inaccurate because they don’t have enough data to accurately estimate those parameters. The tension between overfitting and underfitting is central to the practice of data science.</p>
<!-- DK: Note that this situation is different from Chapter 8 in that fitted values and predicted values are not the same thing! The fitted value, for a combination of values for treatment and solo, is something 0.30, meaning that 30% of the people in this bucket votes. But the predicted value must be 0 or 1. Either you voted or you didn't. This example is clearly causal and so you need a Rubin Table with 5 potential outcome columns. The key difference in this chapter is that we are using lots of right hand side variables, both continuous and discrete. -->
</div>
<div id="wisdom-1" class="section level3">
<h3>
<span class="header-section-number">9.5.2</span> Wisdom</h3>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:unnamed-chunk-778"></span>
<img src="other/images/Wisdom.jpg" alt="Wisdom" width="1280"><!--
<p class="caption marginnote">-->FIGURE 9.5: Wisdom<!--</p>-->
<!--</div>--></span>
</p>
<p>Let’s consider one of the most important virtues of data science: wisdom. The map from our data to our question. Recall that our mission here is to increase our voter turnout while we are running for Governor.</p>
<p>To investigate this, we are given a dataset in which respondents were encouraged to vote under four treatments. This was accomplished by sending a letter to citizens that voted in the previous primary election with varying degrees of social pressure. The remainder of the respondents fall under a control group, which received no such mailings. The dataset offers a number of details about each respondent, including their age, sex, treatment type, and voting outcome.</p>
<p>What we truly want to know is <em>how to make citizens vote</em>. One immediate problem with our dataset is that, due to our study population, we are only studying people that voted in the previous primary election. In other words, if someone <em>did not</em> vote in the previous primary election, they were not included. This would be a large problem, since that means we can only figure out how to make citizens <em>that have already voted</em> vote. Though we can’t be sure, it is reasonable to assume that it is easier to encourage citizens to vote in the next primary election if they have a history of recently voting in primary elections.</p>
<p>Does this mean our data is unhelpful? Of course not! With four treatments (and therefore four different methods of encouraging voting), we can gain quite a bit of knowledge. Mostly, we will know the most effective way to incentivize people with a history of voting to vote again. We will also know if no method of persuasion (the control) is the best option. We will further be able to tell if certain methods of persuasion work better for certain groups of people, according to factors such as age, sex, or household size. This can help tremendously in our election.</p>
<p>That being said, the map from our question to our data is almost never perfect. In data science, we often have to look at our data, understand its limitations, and try our best to make inferences that help our cause.</p>
</div>
<div id="justice-and-courage-1" class="section level3">
<h3>
<span class="header-section-number">9.5.3</span> Justice and Courage</h3>
<!-- MF: What should the Preceptor tables look like with these models? Like chapter 3. Should each model have its own Preceptor Table? No! Just one preceptor table at the start, with 5 columns under Y, and 4 covariates, where one is treatment assigned. -->
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:unnamed-chunk-779"></span>
<img src="other/images/Justice.jpg" alt="Justice" width="960"><!--
<p class="caption marginnote">-->FIGURE 9.6: Justice<!--</p>-->
<!--</div>--></span>
</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:unnamed-chunk-780"></span>
<img src="other/images/Courage.jpg" alt="Courage" width="1024"><!--
<p class="caption marginnote">-->FIGURE 9.7: Courage<!--</p>-->
<!--</div>--></span>
</p>
<p>Because we will be going through a series of models in this chapter, it is useful to combine the virtues of Justice and Courage. To begin, let’s model <code>primary_06</code>, which represents whether a citizen voted or not, against sex to see if there is a connection.</p>
<div id="voting-and-sex" class="section level4">
<h4>
<span class="header-section-number">9.5.3.1</span> Voting and Sex</h4>
<!-- MF: I used family = gaussian as I noted it in the lower section drafts, but can't find the purpose online. Also, stan_glm is taking a very long time to run. Is this a concern? Never mention gaussian or the family argument. -->
<p>Let’s start with a simple model: the effect of voting in the 2006 election and sex. First, let’s look at the results of <code>primary_06</code> after grouping by <code>sex</code> to see the number of females and males who did or did not vote. Recall that a value of 1 for <code>primary_06</code> means that the citizen <em>did</em> vote, while a value of 0 means that they <em>did not</em>.</p>
<div class="sourceCode" id="cb985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb985-1"><a href="n-parameters.html#cb985-1"></a>ch9_sham <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb985-2"><a href="n-parameters.html#cb985-2"></a><span class="st">  </span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb985-3"><a href="n-parameters.html#cb985-3"></a><span class="st">  </span><span class="kw">count</span>(primary_<span class="dv">06</span>) </span></code></pre></div>
<pre><code>## # A tibble: 4 x 3
## # Groups:   sex [2]
##   sex    primary_06     n
##   &lt;chr&gt;       &lt;int&gt; &lt;int&gt;
## 1 Female          0  3437
## 2 Female          1  1563
## 3 Male            0  3332
## 4 Male            1  1668</code></pre>
<p>Eyeballing the figures, you may have noticed that slightly more male respondents voted than female respondents. Let’s investigate this using <code>stan_glm</code>.</p>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb987-1"><a href="n-parameters.html#cb987-1"></a>model_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_sham, </span>
<span id="cb987-2"><a href="n-parameters.html#cb987-2"></a>                 <span class="dt">formula =</span> primary_<span class="dv">06</span> <span class="op">~</span><span class="st"> </span>sex, </span>
<span id="cb987-3"><a href="n-parameters.html#cb987-3"></a>                 <span class="dt">family =</span> <span class="kw">gaussian</span>(), </span>
<span id="cb987-4"><a href="n-parameters.html#cb987-4"></a>                 <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="n-parameters.html#cb988-1"></a><span class="kw">print</span>(model_<span class="dv">1</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      primary_06 ~ sex
##  observations: 10000
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) 0.313  0.007 
## sexMale     0.021  0.010 
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 0.468  0.003 
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>Here, the (Intercept) variable represents our “baseline for comparison” female group of voters. The median value is the percentage of the female group that voted in the 2006 election, as the average of 1 (voted) and 0 (didn’t vote) gives us the percentage of the group that <em>did</em> vote. That is to say– about 31% of the female group voted in the primary election. The sexMale term corresponds to the <em>offset</em> in intercept for the male respondents relative to the female respondents. In other words, the female respondents had an average intercept of .31 = 31% while the male respondent intercept of .31 + .012 = .322 = 32% voting rate. Therefore, male participants were <em>slightly more</em> likely to vote in the 2006 primary election, as compared to the female participants.</p>
</div>
<div id="voting-and-age" class="section level4">
<h4>
<span class="header-section-number">9.5.3.2</span> Voting and Age</h4>
<p>Now that we’ve seen the relationship between sex and voting, let’s take a look at age. Begin by grouping our observations by <code>age</code> and counting by <code>primary_06</code>, which gives us counts for 1 (yes) or 0 (no) for number voting in each age category.</p>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="n-parameters.html#cb990-1"></a>age &lt;-<span class="st"> </span>ch9_sham <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb990-2"><a href="n-parameters.html#cb990-2"></a><span class="st">  </span><span class="kw">group_by</span>(age) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb990-3"><a href="n-parameters.html#cb990-3"></a><span class="st">  </span><span class="kw">count</span>(primary_<span class="dv">06</span>) </span>
<span id="cb990-4"><a href="n-parameters.html#cb990-4"></a></span>
<span id="cb990-5"><a href="n-parameters.html#cb990-5"></a>age</span></code></pre></div>
<pre><code>## # A tibble: 150 x 3
## # Groups:   age [78]
##      age primary_06     n
##    &lt;dbl&gt;      &lt;int&gt; &lt;int&gt;
##  1    20          0   122
##  2    20          1    16
##  3    21          0   137
##  4    21          1    24
##  5    22          0   103
##  6    22          1    19
##  7    23          0   124
##  8    23          1    23
##  9    24          0   106
## 10    24          1    16
## # … with 140 more rows</code></pre>
<p>To explore this relationship visually, let’s create a graph. We are coercing <code>primary_06</code> into a character variable as it more closely represents “yes” or “no” as opposed to a numerical value.</p>
<div class="sourceCode" id="cb992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb992-1"><a href="n-parameters.html#cb992-1"></a>age <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb992-2"><a href="n-parameters.html#cb992-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">primary_06 =</span> <span class="kw">as.character</span>(primary_<span class="dv">06</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb992-3"><a href="n-parameters.html#cb992-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> n, <span class="dt">color =</span> primary_<span class="dv">06</span>)) <span class="op">+</span></span>
<span id="cb992-4"><a href="n-parameters.html#cb992-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb992-5"><a href="n-parameters.html#cb992-5"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb992-6"><a href="n-parameters.html#cb992-6"></a>    <span class="dt">title =</span> <span class="st">"Relationship Between Age and Voting"</span>,</span>
<span id="cb992-7"><a href="n-parameters.html#cb992-7"></a>    <span class="dt">subtitle =</span> <span class="st">"In the 2006 Primary Elections"</span>,</span>
<span id="cb992-8"><a href="n-parameters.html#cb992-8"></a>    <span class="dt">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb992-9"><a href="n-parameters.html#cb992-9"></a>    <span class="dt">y =</span> <span class="st">"Count"</span></span>
<span id="cb992-10"><a href="n-parameters.html#cb992-10"></a>  )</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-785-1.png" width="672"></p>
<p>There are some interesting takeaways here.
- First, in almost every age bracket (other than above 90), the majority participants did <em>not</em> vote.
- The spike between ages 40 and 60 illustrates that most participants exist in this age bracket.
- The differences between voters and non-voters narrows greatly after age 60.</p>
<p>Let’s look at the results of our regression.</p>
<!-- MF: Age isn't showing unique values (just one intercept and then `age`). Is that a problem? No. Same explanation as model above. -->
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb993-1"><a href="n-parameters.html#cb993-1"></a>model_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_sham, </span>
<span id="cb993-2"><a href="n-parameters.html#cb993-2"></a>                 <span class="dt">formula =</span> primary_<span class="dv">06</span> <span class="op">~</span><span class="st"> </span>age, </span>
<span id="cb993-3"><a href="n-parameters.html#cb993-3"></a>                 <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="n-parameters.html#cb994-1"></a><span class="kw">print</span>(model_<span class="dv">2</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      primary_06 ~ age
##  observations: 10000
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) 0.108  0.016 
## age         0.004  0.000 
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 0.463  0.003 
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<div id="voting-and-treatment" class="section level4">
<h4>
<span class="header-section-number">9.5.3.3</span> Voting and Treatment</h4>
<p>Looking at the relationship between primary voting and treatment.</p>
<div class="sourceCode" id="cb996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb996-1"><a href="n-parameters.html#cb996-1"></a>model_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_sham, </span>
<span id="cb996-2"><a href="n-parameters.html#cb996-2"></a>                 <span class="dt">formula =</span> primary_<span class="dv">06</span> <span class="op">~</span><span class="st"> </span>treatment <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb996-3"><a href="n-parameters.html#cb996-3"></a>                 <span class="dt">family =</span> <span class="kw">gaussian</span>(), </span>
<span id="cb996-4"><a href="n-parameters.html#cb996-4"></a>                 <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb997-1"><a href="n-parameters.html#cb997-1"></a><span class="kw">print</span>(model_<span class="dv">3</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      primary_06 ~ treatment - 1
##  observations: 10000
##  predictors:   5
## ------
##                     Median MAD_SD
## treatmentCivic Duty 0.325  0.014 
## treatmentHawthorne  0.323  0.014 
## treatmentControl    0.312  0.006 
## treatmentSelf       0.337  0.014 
## treatmentNeighbors  0.365  0.015 
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 0.467  0.003 
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>Recall that the four treatments varied in the amount of social shaming involved. While each sent the message, “DO YOUR CIVIC DUTY - VOTE!”, there were differences. Briefly:</p>
<ul>
<li>The first treatment, Civic Duty, also read, “Remember your rights and responsibilities as a citizen. Remember to vote.” (Least pressure)</li>
<li>Hawthorne told the voters that they were being studied and their voting behavior would be examined through public records. (Slighly more pressure)</li>
<li>Self included the recent voting record of each member of the household, placing the word “Voted” next to their name if they did in fact vote in the 2004 election or a blank space next to the name if they did not. The households were also told, “we intend to mail an updated chart” with the voting record of the household members after the 2006 primary. (Moderate pressure)</li>
<li>Neighbors provides the household members’ voting records, as well as the voting records of those who live nearby. This mailing also told recipients, “we intend to mail an updated chart” of who voted in the 2006 election to the entire neighborhood. (Most pressure)</li>
</ul>
<p>The Control group had the least active voters with a median of .297 = 29.7% of participants voting. The Civic Duty treatment (least pressure) had slighly more at .314 = 31.4% of participants voting. The Hawthorne group (slightly more pressure) increased upon Civic Duty for a total of .322 = 32.2% voting. The Self group (moderate pressure) increased even still, with .345 = 34.5% of the group voting. Finally, the Neighbors group (with the most social pressure) yielded the highest voting rate of .378 = 37.8%.</p>
<p>This means that, as we hoped, more social pressure = higher voting turnout. That being said, the percent differences were not large. The biggest leap came from the Neighbors group, suggesting that the pressure of your vote being publicized to your community increases turnout more than a simple encouragement.</p>
</div>
<div id="voting-sex-solo-treatment" class="section level4">
<h4>
<span class="header-section-number">9.5.3.4</span> Voting &amp; (Sex + Solo + Treatment)</h4>
<p>Looking at the relationship between primary voting, sex, living alone, and treatment.</p>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb999-1"><a href="n-parameters.html#cb999-1"></a>model_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_sham, </span>
<span id="cb999-2"><a href="n-parameters.html#cb999-2"></a>                 <span class="dt">formula =</span> primary_<span class="dv">06</span> <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>solo <span class="op">+</span><span class="st"> </span>treatment, </span>
<span id="cb999-3"><a href="n-parameters.html#cb999-3"></a>                 <span class="dt">family =</span> <span class="kw">gaussian</span>(), </span>
<span id="cb999-4"><a href="n-parameters.html#cb999-4"></a>                 <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1000-1"><a href="n-parameters.html#cb1000-1"></a><span class="kw">print</span>(model_<span class="dv">4</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      primary_06 ~ sex + solo + treatment
##  observations: 10000
##  predictors:   7
## ------
##                    Median MAD_SD
## (Intercept)         0.308  0.015
## sexMale             0.021  0.009
## soloTRUE            0.044  0.014
## treatmentHawthorne -0.002  0.021
## treatmentControl   -0.013  0.016
## treatmentSelf       0.012  0.019
## treatmentNeighbors  0.039  0.021
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 0.467  0.003 
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>INTERACTION MODEL with all of the above plus solo and treatment</p>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1002-1"><a href="n-parameters.html#cb1002-1"></a>model_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">data =</span> ch9_sham, </span>
<span id="cb1002-2"><a href="n-parameters.html#cb1002-2"></a>                 <span class="dt">formula =</span> primary_<span class="dv">06</span> <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>solo <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>solo <span class="op">*</span><span class="st"> </span>treatment, </span>
<span id="cb1002-3"><a href="n-parameters.html#cb1002-3"></a>                 <span class="dt">family =</span> <span class="kw">gaussian</span>(), </span>
<span id="cb1002-4"><a href="n-parameters.html#cb1002-4"></a>                 <span class="dt">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1003-1"><a href="n-parameters.html#cb1003-1"></a><span class="kw">print</span>(model_<span class="dv">5</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      primary_06 ~ sex + solo + treatment + solo * treatment
##  observations: 10000
##  predictors:   11
## ------
##                             Median MAD_SD
## (Intercept)                  0.305  0.016
## sexMale                      0.021  0.009
## soloTRUE                     0.069  0.040
## treatmentHawthorne           0.010  0.022
## treatmentControl            -0.009  0.017
## treatmentSelf                0.011  0.021
## treatmentNeighbors           0.038  0.022
## soloTRUE:treatmentHawthorne -0.089  0.061
## soloTRUE:treatmentControl   -0.031  0.045
## soloTRUE:treatmentSelf       0.003  0.057
## soloTRUE:treatmentNeighbors  0.007  0.057
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 0.467  0.003 
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<!-- MF: As it stands, I have all five models in this section. Should the interaction model maybe be in a later, separate section? No. -->
</div>
</div>
<div id="temperance-1" class="section level3">
<h3>
<span class="header-section-number">9.5.4</span> Temperance</h3>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:unnamed-chunk-794"></span>
<img src="other/images/Temperance.jpg" alt="Temperance" width="960"><!--
<p class="caption marginnote">-->FIGURE 9.8: Temperance<!--</p>-->
<!--</div>--></span>
</p>
<p>Finally, let’s remember the virtue of Temperance. The gist of temperance is: be humble with our inferences, as our inferences are always, certainly, and unfortunately not going to match the real world. How does this apply to our shaming scenario?</p>
<p>Prediction uncertainty is the main culprit. No matter how hard we try, <em>we cannot predict the future</em>. Though we now have conclusions about how shaming impacted voters in the 2006 primary elections, we do not have the confidence to say that what worked or didn’t work then would work now.</p>
<p>For instance, perhaps the impact of your neighbors knowing your voting history is greater in the midst of a pandemic, where you may be locked inside with few interactions outside of your immediate proximity. Perhaps the opposite is true. These <em>unknown unknowns</em> cannot be accounted for in our models. We cannot predict a pandemic, nor can we predict how this will change the way that people vote or respond to flyers.</p>
<p>There is also the issue of representitiveness. Do the voters of the 2006 primary election (who have already demonstrated a willingness to vote in the 2004 primary election) truly represent the people voting in <strong>our</strong> gubernatorial election?</p>
<p>These complications are why we must make inferences with a grain of salt. That is not to say that all data science is unhelpful! On the contrary, acknowledging our deficits will only make our inferences (and the actions we take because of them) stronger.</p>
</div>
</div>
<div id="causal-effects-of-treament" class="section level2">
<h2>
<span class="header-section-number">9.6</span> Causal Effects of <code>treament</code>
</h2>
<p>We will now be looking into the causal effect of the treatment variable on the 2006 primary election. To start, let’s build a model using <code>stan_glm()</code> followed by a regression table.</p>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1005-1"><a href="n-parameters.html#cb1005-1"></a><span class="co"># obj.1 &lt;- stan_glm(data = shaming, </span></span>
<span id="cb1005-2"><a href="n-parameters.html#cb1005-2"></a><span class="co">#                 formula = primary_06 ~ treatment - 1, </span></span>
<span id="cb1005-3"><a href="n-parameters.html#cb1005-3"></a><span class="co">#                 family = gaussian(), </span></span>
<span id="cb1005-4"><a href="n-parameters.html#cb1005-4"></a><span class="co">#                 refresh = 0)</span></span></code></pre></div>
<p>This table shows us each of the five treatments and their beta coefficients, along with a 95% Confidence Interval for these coefficients. The Control provides us with a baseline.</p>
<!-- Talk about what these results mean.  Then, create the same model but with a different structure. -->
<div class="sourceCode" id="cb1006"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1006-1"><a href="n-parameters.html#cb1006-1"></a><span class="co"># obj.2 &lt;- stan_glm(data = shaming, </span></span>
<span id="cb1006-2"><a href="n-parameters.html#cb1006-2"></a><span class="co">#                 formula = primary_06 ~ treatment, </span></span>
<span id="cb1006-3"><a href="n-parameters.html#cb1006-3"></a><span class="co">#                 family = gaussian(), </span></span>
<span id="cb1006-4"><a href="n-parameters.html#cb1006-4"></a><span class="co">#                 refresh = 0)</span></span></code></pre></div>
<!-- Explain how these two models are the same, except in how they define the parameters. Show us the math like Gelman does. Write down the math. For simple. -->
<!-- Once we talk about these things --- and, again, this is exactly what we have talked about in chapter 8 --- we can do a bit more. Like discuss how we are using 99%, because there is nothing magical aboyt 95%, other than convention. I also think it would be fun to show a nice graphic of this, highlighting how the estimates for Civic and Hawthorne overlap.  -->
<div id="interactions" class="section level3">
<h3>
<span class="header-section-number">9.6.1</span> Interactions</h3>
<!-- This is new. With only two parameters, we can't really look at interaction effects. Need to discuss interaction effects in general. Also, note that heterogenous treatment effects are the same thing as interaction effects that involve a treatment effect as one of the variables.  -->
<!-- Feel free to build up this code, and other examples, more slowly than I am doing it here. -->
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="n-parameters.html#cb1007-1"></a><span class="co"># obj.3 &lt;- stan_glm(data = shaming, </span></span>
<span id="cb1007-2"><a href="n-parameters.html#cb1007-2"></a><span class="co">#                 formula = primary_06 ~ sex + treatment + sex:treatment, </span></span>
<span id="cb1007-3"><a href="n-parameters.html#cb1007-3"></a><span class="co">#                 family = gaussian(), </span></span>
<span id="cb1007-4"><a href="n-parameters.html#cb1007-4"></a><span class="co">#                 refresh = 0)</span></span></code></pre></div>
<!-- Takes a while to explain what all this means. -->
<!-- Two key issues: 1) Interpreting lots of parameters in a model. interactions, heterogenous treatment effects. shaming using lm().  -->
<!-- Treatment effect is not the same thing as a coefficient. -->
<!-- 
intercept

Interactions --- use: income ~ party*something

heterogeneous treatment effects --- use:  att_start ~ treatment*something 
just a fancy way of saying interaction effects, but with a variable which us causal


What problems do we face? All the things that make modeling difficult. Why is this so hard? -->
<!-- Centering. -->
<!-- Might naively just take the value for each bucket. But that overfits! Need to put down some structure, like ordering. -->
<!-- income category, party id, pooling, age, -->
<!-- overfitting/underfitting bias/variance -->
<!-- We must have left bootstrapping behind by now. No more bootstraps, at least for the purpose of calculating uncertainty. (We will use it later for the purpose of out-of-sample testing and avoiding overfitting.) Key lesson is that overfitting is easy. You can't just estimate a value for each cell. You need to smooth and borrow strength. Of course, the only way to do that is with a Bayesian approach. Right? We don't want to get into hacked likelihood approaches. -->
<!-- cces looks perfect for this project. There are 400,000 rows, so it seems like you ought to have plenty of data for anything you want, but once you realize there are 51 states and 10 years, things get sparse fast. We only have 15 observations, for example, for Wyoming in 2007. Once you start subsetting by race and education, you have no choice but to start borrowing strength.  -->
<!-- So, just what will we use? rstanarm(). If so (and if we have not introduced it earlier), we can begin with seeing how it is similar to lm() and then expand. This means that, in one paramter chapter, we should be doing lm( ~ 1). In two parameter, lm( ~ treatment) --- if treatment is zero one --- or, perhaps better, lm( ~ -1 + treatment) if treatment is a factor/character with two levels. We might also have introduced  -->

<!-- Add a couple more of the chapters? Or maybe put them in chapter 11? -->
<!-- Cut the recipe, bake, stuff? Not really needed for chapters 11 and 12. -->
<!-- Replace lm() with stan_glm()? -->
<!-- Get rid of multi-category example discussion? No! Hope to do pyTorch at some point. -->
<!-- 2) Each section ends with the code we have done. That seems redundant and confusing. -->
<!-- 3) Need to make the approach here mesh with the approaches used in chapter 11 and 12. What can we cut from here that is not used? How should we change later chapters to be consistent with this modern approach? -->
<!-- 4) I am concerned about the ames_snippets.R code used in the original but, maybe, not needed here. -->
<!-- 6) Many sections begun with a weird code chunk. These should be cleaned up and organized. -->
<!-- 7) Deal with the missing references. Need to add them to the bib. -->
<!-- 8) Maybe follow their example with r pkg(dplyr) instead of **dplyr**. -->
</div>
</div>
</div></body></html>

<p style="text-align: center;">
<a href="three-parameters.html"><button class="btn btn-default">Previous</button></a>
<a href="model-choice.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2020-10-26
</p>
</div>
</div>



</body>
</html>
